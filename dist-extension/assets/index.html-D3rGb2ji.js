import{d as ie,u as ce,r as m,c as u,o as ue,f as h,a as w,g as v,b as s,n as I,e as o,w as l,p as f,q as de,s as B,v as fe,x as pe,t as c,i as y,F as ve,h as me,y as he,z as q,A as ge,B as _e,C as ye,D as be,G as we,H as ke,_ as Te,j as Se,k as Le,l as Pe,m as Ce}from"./_plugin-vue_export-helper-Ch0c2NRu.js";import"./security-6RDsp77e.js";const Ve={class:"security-popup"},Ue={class:"header"},Be={class:"logo"},Ae={class:"status"},He={class:"security-score"},xe={class:"score-text"},ze={class:"score-info"},$e={class:"current-page"},Re={class:"page-info"},De={class:"url"},Ie={class:"badges"},Me={class:"stats"},Ee={class:"stat-item"},Ne={class:"stat-number"},Oe={class:"stat-item"},je={class:"stat-number"},Ke={class:"stat-item"},We={class:"stat-number"},qe={key:0,class:"recent-threats"},Fe={class:"threat-list"},Xe={class:"threat-info"},Ge={class:"threat-title"},Je={class:"threat-time"},Qe={class:"actions"},Ye={class:"phishing-detector"},Ze={class:"result-header"},et=["innerHTML"],tt={key:1,class:"analyzing-tips"},st={class:"quick-toggles"},at={class:"toggle-item"},ot={class:"toggle-item"},lt={class:"toggle-item"},nt=ie({__name:"App",setup(M){const i=ce(),H=m(!1),C=m("åŠ è½½ä¸­..."),x=m(!1),V=m(""),z=m(!1),k=m(""),T=m(""),S=m(!1),L=m(!0),E=u(()=>i.isActive),g=u(()=>i.securityScore),_=u(()=>i.settings),F=u(()=>{try{return new URL(V.value).hostname}catch{return C.value}}),$=u(()=>{const t=F.value;return i.threats.filter(e=>{try{return new URL(e.url).hostname===t}catch{return e.url.includes(t)}})}),N=u(()=>$.value.slice(0,10)),O=u(()=>{const t=$.value,e={totalThreats:t.length,blockedThreats:t.filter(a=>a.blocked).length,allowedThreats:t.filter(a=>!a.blocked).length,threatsByType:{},threatsByLevel:{},lastScanTime:Date.now()};return t.forEach(a=>{e.threatsByType[a.type]||(e.threatsByType[a.type]=0),e.threatsByType[a.type]++}),t.forEach(a=>{e.threatsByLevel[a.level]||(e.threatsByLevel[a.level]=0),e.threatsByLevel[a.level]++}),e}),j=u(()=>{const t=new Date;t.setHours(0,0,0,0);const e=t.getTime();return $.value.filter(a=>a.blocked&&a.timestamp>=e).length}),X=u(()=>g.value>=90?"success":g.value>=70?"warning":"danger"),G=u(()=>g.value>=90?"å®‰å…¨":g.value>=70?"æ³¨æ„":"å±é™©"),J=u(()=>L.value?"safe":"danger"),Q=u(()=>L.value?"âœ… ç½‘ç«™å®‰å…¨":"âš ï¸ ç–‘ä¼¼é’“é±¼ç½‘ç«™");function Y(t){return t>=90?"#67c23a":t>=70?"#e6a23c":"#f56c6c"}function Z(t){return t>=90?"ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½":t>=70?"å­˜åœ¨ä¸€äº›å®‰å…¨é£é™©":"å‘ç°ä¸¥é‡å®‰å…¨é—®é¢˜"}function ee(t){return{low:"#909399",medium:"#e6a23c",high:"#f56c6c",critical:"#f56c6c"}[t]||"#909399"}function te(t){return{malicious_url:"æ¶æ„URL",xss_attack:"XSSæ”»å‡»",tracker:"éšç§è¿½è¸ª",insecure_form:"ä¸å®‰å…¨è¡¨å•",suspicious_script:"å¯ç–‘è„šæœ¬",phishing:"é’“é±¼ç½‘ç«™"}[t]||"æœªçŸ¥å¨èƒ"}function se(t){const a=Date.now()-t,r=Math.floor(a/6e4);if(r<1)return"åˆšåˆš";if(r<60)return`${r}åˆ†é’Ÿå‰`;const d=Math.floor(r/60);return d<24?`${d}å°æ—¶å‰`:`${Math.floor(d/24)}å¤©å‰`}async function ae(){H.value=!0;try{await i.scanCurrentPage()}catch(t){console.error("æ‰«æå¤±è´¥:",t)}finally{H.value=!1}}function oe(){typeof chrome<"u"&&chrome.runtime&&chrome.runtime.openOptionsPage()}async function R(){try{await i.updateSettings(_.value)}catch(t){console.error("æ›´æ–°è®¾ç½®å¤±è´¥:",t)}}async function le(){if(k.value.trim()){S.value=!0,T.value="";try{const e=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer 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","HTTP-Referer":"https://github.com/web-security-guardian","X-Title":"Web Security Guardian","Content-Type":"application/json"},body:JSON.stringify({model:"tngtech/deepseek-r1t2-chimera:free",messages:[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªç½‘ç»œå®‰å…¨ä¸“å®¶ï¼Œä¸“é—¨è¯†åˆ«é’“é±¼ç½‘ç«™ã€‚è¯·åˆ†æç”¨æˆ·æä¾›çš„URLï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ã€‚å›ç­”è¦ç®€æ´æ˜äº†ï¼ŒåŒ…å«ï¼š1.åˆ¤æ–­ç»“æœï¼ˆå®‰å…¨/å±é™©ï¼‰2.ä¸»è¦åŸå›  3.é£é™©ç­‰çº§ã€‚ç”¨ä¸­æ–‡å›ç­”ï¼Œæ ¼å¼æ¸…æ™°ã€‚"},{role:"user",content:`è¯·åˆ†æè¿™ä¸ªç½‘å€æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ï¼š${k.value}

è¯·ä»ä»¥ä¸‹æ–¹é¢åˆ†æï¼š
1. åŸŸåç‰¹å¾ï¼ˆæ˜¯å¦ä»¿å†’çŸ¥åç½‘ç«™ï¼‰
2. URLç»“æ„ï¼ˆæ˜¯å¦æœ‰å¼‚å¸¸å­—ç¬¦æˆ–ç¼–ç ï¼‰
3. é¡¶çº§åŸŸåå¯ä¿¡åº¦
4. æ˜¯å¦åŒ…å«å¯ç–‘å…³é”®è¯
5. ç»¼åˆå®‰å…¨è¯„ä¼°`}]})});if(!e.ok)throw new Error(`APIè¯·æ±‚å¤±è´¥: ${e.status}`);const r=(await e.json()).choices[0].message.content,d=["å±é™©","é’“é±¼","ä¸å®‰å…¨","é£é™©","å¯ç–‘","ä»¿å†’","æ¬ºè¯ˆ"],b=["å®‰å…¨","æ­£å¸¸","å¯ä¿¡","åˆæ³•"],p=d.some(P=>r.includes(P)),U=b.some(P=>r.includes(P));L.value=!p||U&&!r.includes("é«˜é£é™©"),T.value=r.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/###\s*(.*?)(<br>|$)/g,"<h4>$1</h4>")}catch(t){console.error("AIæ£€æµ‹å¤±è´¥:",t),T.value=`<p style="color: #f56c6c;">âŒ æ£€æµ‹å¤±è´¥: ${t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯"}</p><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`,L.value=!0}finally{S.value=!1}}}async function K(){try{if(typeof chrome<"u"&&chrome.tabs){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t.url&&(V.value=t.url,C.value=new URL(t.url).hostname,x.value=t.url.startsWith("https://"),await W(t.url))}}catch(t){console.error("è·å–é¡µé¢ä¿¡æ¯å¤±è´¥:",t),C.value="æ— æ³•è·å–"}}async function W(t){let e=100,a="";try{a=new URL(t).hostname}catch{a=t}i.stats;const r=i.recentThreats,d=r.filter(p=>{try{return new URL(p.url).hostname===a}catch{return p.url.includes(a)}});d.forEach(p=>{switch(p.level){case"critical":e-=30;break;case"high":e-=20;break;case"medium":e-=10;break;case"low":e-=5;break}});const b=t.includes("localhost")||t.includes("127.0.0.1");!t.startsWith("https://")&&!b&&(e-=15,console.log("âŒ æœªä½¿ç”¨HTTPSï¼Œæ‰£15åˆ†")),e=Math.max(0,Math.min(100,e)),i.currentPageAnalysis={url:t,score:e,threats:d,recommendations:e<90?["å‘ç°å®‰å…¨å¨èƒï¼Œå»ºè®®è°¨æ…æ“ä½œ"]:["ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½"],scanTime:Date.now(),isSecure:e>=90},console.log(`ğŸ” é¡µé¢å®‰å…¨è¯„åˆ†: ${e}`),console.log(`ğŸ“Š å½“å‰é¡µé¢å¨èƒ: ${d.length} / æ€»å¨èƒ: ${r.length}`)}function ne(){typeof chrome<"u"&&chrome.storage&&chrome.storage.onChanged.addListener((t,e)=>{e==="local"&&(console.log("ğŸ“¦ Storage changed:",t),(t.security_stats||t.threat_history)&&(i.loadStats(),i.loadThreats(),V.value&&W(V.value)))})}function re(){typeof chrome<"u"&&chrome.tabs&&chrome.tabs.onActivated.addListener(async()=>{console.log("ğŸ”„ Tab switched, refreshing page info"),await K()})}return ue(async()=>{await i.initialize(),await K(),ne(),re()}),(t,e)=>{const a=h("el-icon"),r=h("el-button"),d=h("el-badge"),b=h("el-progress"),p=h("el-tag"),U=h("el-input"),P=h("el-dialog"),D=h("el-switch");return v(),w("div",Ve,[s("div",Ue,[s("div",Be,[o(a,{size:"24",color:"#667eea"},{default:l(()=>[o(f(de))]),_:1}),e[6]||(e[6]=s("h1",null,"å®‰å…¨å®ˆæŠ¤è€…",-1))]),s("div",Ae,[o(d,{value:j.value,class:"badge"},{default:l(()=>[o(r,{type:E.value?"success":"danger",size:"small",circle:""},{default:l(()=>[o(a,null,{default:l(()=>[E.value?(v(),B(f(fe),{key:0})):(v(),B(f(pe),{key:1}))]),_:1})]),_:1},8,["type"])]),_:1},8,["value"])])]),s("div",He,[o(b,{type:"circle",percentage:g.value,color:Y(g.value),width:80},{default:l(({percentage:n})=>[s("span",xe,c(n),1)]),_:1},8,["percentage","color"]),s("div",ze,[e[7]||(e[7]=s("h3",null,"å®‰å…¨è¯„åˆ†",-1)),s("p",null,c(Z(g.value)),1)])]),s("div",$e,[e[8]||(e[8]=s("h3",null,"å½“å‰é¡µé¢",-1)),s("div",Re,[s("div",De,c(C.value),1),s("div",Ie,[o(p,{type:x.value?"success":"warning",size:"small"},{default:l(()=>[y(c(x.value?"HTTPS":"HTTP"),1)]),_:1},8,["type"]),o(p,{type:X.value,size:"small"},{default:l(()=>[y(c(G.value),1)]),_:1},8,["type"])])])]),s("div",Me,[s("div",Ee,[s("div",Ne,c(O.value.blockedThreats),1),e[9]||(e[9]=s("div",{class:"stat-label"},"å·²é˜»æ­¢å¨èƒ",-1))]),s("div",Oe,[s("div",je,c(O.value.totalThreats),1),e[10]||(e[10]=s("div",{class:"stat-label"},"æ£€æµ‹åˆ°å¨èƒ",-1))]),s("div",Ke,[s("div",We,c(j.value),1),e[11]||(e[11]=s("div",{class:"stat-label"},"ä»Šæ—¥é˜»æ­¢",-1))])]),N.value.length>0?(v(),w("div",qe,[e[12]||(e[12]=s("h3",null,"æœ€è¿‘å¨èƒ",-1)),s("div",Fe,[(v(!0),w(ve,null,me(N.value.slice(0,3),n=>(v(),w("div",{key:n.id,class:"threat-item"},[o(a,{color:ee(n.level)},{default:l(()=>[o(f(q))]),_:1},8,["color"]),s("div",Xe,[s("div",Ge,c(te(n.type)),1),s("div",Je,c(se(n.timestamp)),1)]),o(p,{type:n.blocked?"success":"warning",size:"small"},{default:l(()=>[y(c(n.blocked?"å·²é˜»æ­¢":"å·²æ£€æµ‹"),1)]),_:2},1032,["type"])]))),128))])])):I("",!0),s("div",Qe,[o(r,{type:"primary",onClick:ae,loading:H.value,style:{flex:"1"}},{default:l(()=>[o(a,null,{default:l(()=>[o(f(he))]),_:1}),e[13]||(e[13]=y(" æ‰«æå½“å‰é¡µé¢ ",-1))]),_:1},8,["loading"]),o(r,{onClick:e[0]||(e[0]=n=>z.value=!0),type:"warning"},{default:l(()=>[o(a,null,{default:l(()=>[o(f(q))]),_:1}),e[14]||(e[14]=y(" AIæ£€æµ‹ ",-1))]),_:1}),o(r,{onClick:oe},{default:l(()=>[o(a,null,{default:l(()=>[o(f(ge))]),_:1}),e[15]||(e[15]=y(" è®¾ç½® ",-1))]),_:1})]),o(P,{modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=n=>z.value=n),title:"AIé’“é±¼ç½‘ç«™æ£€æµ‹",width:"90%","close-on-click-modal":!1},{default:l(()=>[s("div",Ye,[o(U,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=n=>k.value=n),placeholder:"è¾“å…¥è¦æ£€æµ‹çš„ç½‘å€ï¼Œä¾‹å¦‚: https://example.com",size:"large",clearable:""},{prepend:l(()=>[o(a,null,{default:l(()=>[o(f(_e))]),_:1})]),_:1},8,["modelValue"]),o(r,{type:"primary",onClick:le,loading:S.value,disabled:!k.value.trim(),style:{width:"100%","margin-top":"12px"},size:"large"},{default:l(()=>[y(c(S.value?"åˆ†æä¸­...":"å¼€å§‹æ£€æµ‹"),1)]),_:1},8,["loading","disabled"]),T.value?(v(),w("div",{key:0,class:ye(["result-box",J.value])},[s("div",Ze,[o(a,{size:"24"},{default:l(()=>[L.value?(v(),B(f(be),{key:0})):(v(),B(f(we),{key:1}))]),_:1}),s("h3",null,c(Q.value),1)]),s("div",{class:"result-content",innerHTML:T.value},null,8,et)],2)):I("",!0),S.value?(v(),w("div",tt,[o(a,{class:"is-loading"},{default:l(()=>[o(f(ke))]),_:1}),e[16]||(e[16]=s("p",null,"AIæ­£åœ¨åˆ†æç½‘å€ç‰¹å¾ï¼Œè¯·ç¨å€™...",-1))])):I("",!0)])]),_:1},8,["modelValue"]),s("div",st,[s("div",at,[e[17]||(e[17]=s("span",null,"æ¶æ„URLé˜²æŠ¤",-1)),o(D,{modelValue:_.value.maliciousUrlProtection,"onUpdate:modelValue":e[3]||(e[3]=n=>_.value.maliciousUrlProtection=n),onChange:R},null,8,["modelValue"])]),s("div",ot,[e[18]||(e[18]=s("span",null,"XSSé˜²æŠ¤",-1)),o(D,{modelValue:_.value.xssProtection,"onUpdate:modelValue":e[4]||(e[4]=n=>_.value.xssProtection=n),onChange:R},null,8,["modelValue"])]),s("div",lt,[e[19]||(e[19]=s("span",null,"è¿½è¸ªå™¨é˜»æ­¢",-1)),o(D,{modelValue:_.value.trackerBlocking,"onUpdate:modelValue":e[5]||(e[5]=n=>_.value.trackerBlocking=n),onChange:R},null,8,["modelValue"])])])])}}}),rt=Te(nt,[["__scopeId","data-v-b1b85a84"]]),A=Se(rt),it=Le();A.use(it);A.use(Pe);for(const[M,i]of Object.entries(Ce))A.component(M,i);A.mount("#app");
