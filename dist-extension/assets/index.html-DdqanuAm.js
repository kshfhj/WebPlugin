import{d as E,u as F,r as C,c,o as X,f,a as h,g as p,b as t,n as G,e as o,w as a,p as v,q as J,s as H,v as K,x as Q,t as i,i as g,F as Y,h as Z,y as ee,z as te,A as se,_ as oe,j as ne,k as ae,l as le,m as ie}from"./_plugin-vue_export-helper-CwtXtYS3.js";const re={class:"security-popup"},ce={class:"header"},ue={class:"logo"},de={class:"status"},_e={class:"security-score"},fe={class:"score-text"},pe={class:"score-info"},ve={class:"current-page"},me={class:"page-info"},ge={class:"url"},he={class:"badges"},ye={class:"stats"},ke={class:"stat-item"},be={class:"stat-number"},Te={class:"stat-item"},we={class:"stat-number"},Se={class:"stat-item"},Pe={class:"stat-number"},Ce={key:0,class:"recent-threats"},Ve={class:"threat-list"},xe={class:"threat-info"},Ue={class:"threat-title"},ze={class:"threat-time"},Ae={class:"actions"},Be={class:"quick-toggles"},He={class:"toggle-item"},Le={class:"toggle-item"},De={class:"toggle-item"},Me=E({__name:"App",setup(V){const l=F(),k=C(!1),b=C("åŠ è½½ä¸­..."),T=C(!1),x=c(()=>l.isActive),u=c(()=>l.securityScore),U=c(()=>l.stats),z=c(()=>l.recentThreats),d=c(()=>l.settings),A=c(()=>l.blockedThreatsToday),L=c(()=>u.value>=90?"success":u.value>=70?"warning":"danger"),D=c(()=>u.value>=90?"å®‰å…¨":u.value>=70?"æ³¨æ„":"å±é™©");function M(s){return s>=90?"#67c23a":s>=70?"#e6a23c":"#f56c6c"}function N(s){return s>=90?"ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½":s>=70?"å­˜åœ¨ä¸€äº›å®‰å…¨é£é™©":"å‘ç°ä¸¥é‡å®‰å…¨é—®é¢˜"}function $(s){return{low:"#909399",medium:"#e6a23c",high:"#f56c6c",critical:"#f56c6c"}[s]||"#909399"}function q(s){return{malicious_url:"æ¶æ„URL",xss_attack:"XSSæ”»å‡»",tracker:"éšç§è¿½è¸ª",insecure_form:"ä¸å®‰å…¨è¡¨å•",suspicious_script:"å¯ç–‘è„šæœ¬",phishing:"é’“é±¼ç½‘ç«™"}[s]||"æœªçŸ¥å¨èƒ"}function I(s){const _=Date.now()-s,r=Math.floor(_/6e4);if(r<1)return"åˆšåˆš";if(r<60)return`${r}åˆ†é’Ÿå‰`;const m=Math.floor(r/60);return m<24?`${m}å°æ—¶å‰`:`${Math.floor(m/24)}å¤©å‰`}async function O(){k.value=!0;try{await l.scanCurrentPage()}catch(s){console.error("æ‰«æå¤±è´¥:",s)}finally{k.value=!1}}function R(){typeof chrome<"u"&&chrome.runtime&&chrome.runtime.openOptionsPage()}async function w(){try{await l.updateSettings(d.value)}catch(s){console.error("æ›´æ–°è®¾ç½®å¤±è´¥:",s)}}async function W(){try{if(typeof chrome<"u"&&chrome.tabs){const[s]=await chrome.tabs.query({active:!0,currentWindow:!0});s.url&&(b.value=new URL(s.url).hostname,T.value=s.url.startsWith("https://"),j(s.url))}}catch(s){console.error("è·å–é¡µé¢ä¿¡æ¯å¤±è´¥:",s),b.value="æ— æ³•è·å–"}}function j(s){let e=100;s.startsWith("https://")||(e-=15,console.log("âŒ æœªä½¿ç”¨HTTPSï¼Œæ‰£15åˆ†")),(s.includes("localhost")||s.includes("127.0.0.1"))&&(e=100),l.currentPageAnalysis={url:s,score:e,threats:[],recommendations:e<90?["å»ºè®®ä½¿ç”¨HTTPSåŠ å¯†è¿æ¥"]:["ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½"],scanTime:Date.now(),isSecure:e>=90},console.log(`ğŸ” é¡µé¢å®‰å…¨è¯„åˆ†: ${e}`)}return X(async()=>{await l.initialize(),await W()}),(s,e)=>{const _=f("el-icon"),r=f("el-button"),m=f("el-badge"),B=f("el-progress"),S=f("el-tag"),P=f("el-switch");return p(),h("div",re,[t("div",ce,[t("div",ue,[o(_,{size:"24",color:"#667eea"},{default:a(()=>[o(v(J))]),_:1}),e[3]||(e[3]=t("h1",null,"å®‰å…¨å®ˆæŠ¤è€…",-1))]),t("div",de,[o(m,{value:A.value,class:"badge"},{default:a(()=>[o(r,{type:x.value?"success":"danger",size:"small",circle:""},{default:a(()=>[o(_,null,{default:a(()=>[x.value?(p(),H(v(K),{key:0})):(p(),H(v(Q),{key:1}))]),_:1})]),_:1},8,["type"])]),_:1},8,["value"])])]),t("div",_e,[o(B,{type:"circle",percentage:u.value,color:M(u.value),width:80},{default:a(({percentage:n})=>[t("span",fe,i(n),1)]),_:1},8,["percentage","color"]),t("div",pe,[e[4]||(e[4]=t("h3",null,"å®‰å…¨è¯„åˆ†",-1)),t("p",null,i(N(u.value)),1)])]),t("div",ve,[e[5]||(e[5]=t("h3",null,"å½“å‰é¡µé¢",-1)),t("div",me,[t("div",ge,i(b.value),1),t("div",he,[o(S,{type:T.value?"success":"warning",size:"small"},{default:a(()=>[g(i(T.value?"HTTPS":"HTTP"),1)]),_:1},8,["type"]),o(S,{type:L.value,size:"small"},{default:a(()=>[g(i(D.value),1)]),_:1},8,["type"])])])]),t("div",ye,[t("div",ke,[t("div",be,i(U.value.blockedThreats),1),e[6]||(e[6]=t("div",{class:"stat-label"},"å·²é˜»æ­¢å¨èƒ",-1))]),t("div",Te,[t("div",we,i(U.value.totalThreats),1),e[7]||(e[7]=t("div",{class:"stat-label"},"æ£€æµ‹åˆ°å¨èƒ",-1))]),t("div",Se,[t("div",Pe,i(A.value),1),e[8]||(e[8]=t("div",{class:"stat-label"},"ä»Šæ—¥é˜»æ­¢",-1))])]),z.value.length>0?(p(),h("div",Ce,[e[9]||(e[9]=t("h3",null,"æœ€è¿‘å¨èƒ",-1)),t("div",Ve,[(p(!0),h(Y,null,Z(z.value.slice(0,3),n=>(p(),h("div",{key:n.id,class:"threat-item"},[o(_,{color:$(n.level)},{default:a(()=>[o(v(se))]),_:1},8,["color"]),t("div",xe,[t("div",Ue,i(q(n.type)),1),t("div",ze,i(I(n.timestamp)),1)]),o(S,{type:n.blocked?"success":"warning",size:"small"},{default:a(()=>[g(i(n.blocked?"å·²é˜»æ­¢":"å·²æ£€æµ‹"),1)]),_:2},1032,["type"])]))),128))])])):G("",!0),t("div",Ae,[o(r,{type:"primary",onClick:O,loading:k.value,style:{flex:"1"}},{default:a(()=>[o(_,null,{default:a(()=>[o(v(ee))]),_:1}),e[10]||(e[10]=g(" æ‰«æå½“å‰é¡µé¢ ",-1))]),_:1},8,["loading"]),o(r,{onClick:R},{default:a(()=>[o(_,null,{default:a(()=>[o(v(te))]),_:1}),e[11]||(e[11]=g(" è®¾ç½® ",-1))]),_:1})]),t("div",Be,[t("div",He,[e[12]||(e[12]=t("span",null,"æ¶æ„URLé˜²æŠ¤",-1)),o(P,{modelValue:d.value.maliciousUrlProtection,"onUpdate:modelValue":e[0]||(e[0]=n=>d.value.maliciousUrlProtection=n),onChange:w},null,8,["modelValue"])]),t("div",Le,[e[13]||(e[13]=t("span",null,"XSSé˜²æŠ¤",-1)),o(P,{modelValue:d.value.xssProtection,"onUpdate:modelValue":e[1]||(e[1]=n=>d.value.xssProtection=n),onChange:w},null,8,["modelValue"])]),t("div",De,[e[14]||(e[14]=t("span",null,"è¿½è¸ªå™¨é˜»æ­¢",-1)),o(P,{modelValue:d.value.trackerBlocking,"onUpdate:modelValue":e[2]||(e[2]=n=>d.value.trackerBlocking=n),onChange:w},null,8,["modelValue"])])])])}}}),Ne=oe(Me,[["__scopeId","data-v-43c4047f"]]),y=ne(Ne),$e=ae();y.use($e);y.use(le);for(const[V,l]of Object.entries(ie))y.component(V,l);y.mount("#app");
