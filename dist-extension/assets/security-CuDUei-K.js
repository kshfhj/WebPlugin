var c=(e=>(e.MALICIOUS_URL="malicious_url",e.XSS_ATTACK="xss_attack",e.SQL_INJECTION="sql_injection",e.TRACKER="tracker",e.INSECURE_FORM="insecure_form",e.SUSPICIOUS_SCRIPT="suspicious_script",e.PHISHING="phishing",e.DATA_LEAK="data_leak",e))(c||{}),t=(e=>(e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e))(t||{});const a=[{id:"script_tag",pattern:/<script[^>]*>[\s\S]*?<\/script>/gi,description:"检测到script标签注入",severity:t.HIGH,enabled:!0},{id:"script_src",pattern:/<script[^>]*src\s*=\s*["'][^"']*["'][^>]*>/gi,description:"检测到外部脚本注入",severity:t.HIGH,enabled:!0},{id:"javascript_protocol",pattern:/javascript\s*:/gi,description:"检测到javascript:伪协议",severity:t.HIGH,enabled:!0},{id:"event_handlers",pattern:/on\w+\s*=\s*["'][^"']*["']/gi,description:"检测到内联事件处理器",severity:t.MEDIUM,enabled:!0},{id:"onerror_handler",pattern:/onerror\s*=\s*["'].*["']/gi,description:"检测到onerror事件利用",severity:t.HIGH,enabled:!0},{id:"iframe_injection",pattern:/<iframe[^>]*>/gi,description:"检测到iframe注入",severity:t.HIGH,enabled:!0},{id:"object_embed",pattern:/<(object|embed)[^>]*>/gi,description:"检测到object/embed标签注入",severity:t.MEDIUM,enabled:!0},{id:"eval_function",pattern:/\beval\s*\(/gi,description:"检测到eval函数调用",severity:t.HIGH,enabled:!0},{id:"function_constructor",pattern:/new\s+Function\s*\(/gi,description:"检测到Function构造函数",severity:t.HIGH,enabled:!0},{id:"document_write",pattern:/document\.(write|writeln)\s*\(/gi,description:"检测到document.write调用",severity:t.MEDIUM,enabled:!0},{id:"inner_html",pattern:/\.innerHTML\s*=\s*[^;]+[<>]/gi,description:"检测到innerHTML危险赋值",severity:t.MEDIUM,enabled:!0},{id:"data_uri",pattern:/data:text\/html[^>]*>/gi,description:"检测到data:URI注入",severity:t.HIGH,enabled:!0},{id:"vbscript",pattern:/vbscript:/gi,description:"检测到VBScript协议",severity:t.HIGH,enabled:!0},{id:"svg_script",pattern:/<svg[^>]*>[\s\S]*?<script/gi,description:"检测到SVG中的脚本注入",severity:t.HIGH,enabled:!0},{id:"meta_refresh",pattern:/<meta[^>]*http-equiv\s*=\s*["']refresh["'][^>]*>/gi,description:"检测到meta refresh重定向",severity:t.MEDIUM,enabled:!0},{id:"base_href",pattern:/<base[^>]*href\s*=\s*["'][^"']*["'][^>]*>/gi,description:"检测到base标签劫持",severity:t.MEDIUM,enabled:!0}],p=[{id:"sql_union",pattern:/(\bunion\b.*\bselect\b|\bselect\b.*\bunion\b)/gi,description:"检测到UNION注入攻击",severity:t.HIGH},{id:"sql_or_always_true",pattern:/(\bor\b\s+[\d\w'"]+\s*=\s*[\d\w'"]+|\d+\s*=\s*\d+)/gi,description:"检测到OR恒真条件",severity:t.HIGH},{id:"sql_comment",pattern:/(--|#|\/\*|\*\/)/g,description:"检测到SQL注释符号",severity:t.MEDIUM},{id:"sql_sleep",pattern:/\b(sleep|benchmark|waitfor\s+delay)\b/gi,description:"检测到时间盲注攻击",severity:t.HIGH},{id:"sql_information_schema",pattern:/\binformation_schema\b/gi,description:"检测到数据库元数据查询",severity:t.HIGH},{id:"sql_exec",pattern:/\b(exec|execute|xp_cmdshell)\b/gi,description:"检测到命令执行尝试",severity:t.CRITICAL},{id:"sql_drop",pattern:/\b(drop|delete|truncate|alter)\b\s+\b(table|database)\b/gi,description:"检测到危险SQL操作",severity:t.CRITICAL},{id:"sql_into_outfile",pattern:/\binto\s+(outfile|dumpfile)\b/gi,description:"检测到文件写入尝试",severity:t.HIGH},{id:"sql_load_file",pattern:/\bload_file\s*\(/gi,description:"检测到文件读取尝试",severity:t.HIGH},{id:"sql_quotes",pattern:/['";].*(\bor\b|\band\b).*['";]/gi,description:"检测到引号闭合注入",severity:t.HIGH}];function b(e){const i=[];a.forEach(r=>{r.pattern.global&&(r.pattern.lastIndex=0)});for(const r of a)r.enabled&&r.pattern.test(e)&&(i.push({id:r.id,description:r.description,severity:r.severity}),r.pattern.global&&(r.pattern.lastIndex=0));return{detected:i.length>0,patterns:i}}function I(e){const i=[];let r=e;try{r=decodeURIComponent(e)}catch{}for(const s of p)s.pattern.test(r)&&(i.push({id:s.id,description:s.description,severity:s.severity}),s.pattern.lastIndex=0);const n=/['"`;\\]+/g,d=r.match(n);return d&&d.length>3&&i.push({id:"sql_special_chars",description:"检测到可疑的特殊字符组合",severity:t.MEDIUM}),{detected:i.length>0,patterns:i}}function o(e){try{return new URL(e).protocol==="https:"}catch{return!1}}function _(e){const i=e.action||window.location.href;return!(e.method.toLowerCase()==="post"&&!o(i)||e.querySelectorAll('input[type="password"], input[name*="password"], input[name*="credit"], input[name*="card"]').length>0&&!o(i))}function g(e){const i=[];return/\b\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}\b/g.test(e)&&i.push("信用卡号"),/\b\d{17}[\dxX]\b/g.test(e)&&i.push("身份证号"),/\b1[3-9]\d{9}\b/g.test(e)&&i.push("手机号"),/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g.test(e)&&i.push("邮箱地址"),/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/g.test(e)&&i.push("IP地址"),/(password|pwd|passwd)\s*[:=]\s*\S+/gi.test(e)&&i.push("密码"),{detected:i.length>0,types:i}}export{t as T,c as a,b,g as c,I as d,_ as i};
