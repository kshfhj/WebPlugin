import{d as K,u as Q,r as k,c as u,o as Y,f as v,a as S,g as p,b as s,n as Z,e as a,w as r,p as _,q as ee,s as M,v as te,x as se,t as i,i as g,F as oe,h as ae,y as ne,z as le,A as re,_ as ce,j as ie,k as ue,l as de,m as fe}from"./_plugin-vue_export-helper-DpwelZh6.js";import"./security-6RDsp77e.js";const me={class:"security-popup"},he={class:"header"},ve={class:"logo"},pe={class:"status"},_e={class:"security-score"},ge={class:"score-text"},ye={class:"score-info"},Te={class:"current-page"},be={class:"page-info"},we={class:"url"},ke={class:"badges"},Se={class:"stats"},Le={class:"stat-item"},Pe={class:"stat-number"},Ce={class:"stat-item"},Be={class:"stat-number"},Ue={class:"stat-item"},Ve={class:"stat-number"},xe={key:0,class:"recent-threats"},He={class:"threat-list"},Ae={class:"threat-info"},De={class:"threat-title"},ze={class:"threat-time"},Re={class:"actions"},Me={class:"quick-toggles"},$e={class:"toggle-item"},Ee={class:"toggle-item"},Ne={class:"toggle-item"},qe=K({__name:"App",setup(V){const n=Q(),P=k(!1),y=k("åŠ è½½ä¸­..."),C=k(!1),T=k(""),x=u(()=>n.isActive),m=u(()=>n.securityScore),h=u(()=>n.settings),$=u(()=>{try{return new URL(T.value).hostname}catch{return y.value}}),B=u(()=>{const t=$.value;return n.threats.filter(e=>{try{return new URL(e.url).hostname===t}catch{return e.url.includes(t)}})}),H=u(()=>B.value.slice(0,10)),A=u(()=>{const t=B.value,e={totalThreats:t.length,blockedThreats:t.filter(o=>o.blocked).length,allowedThreats:t.filter(o=>!o.blocked).length,threatsByType:{},threatsByLevel:{},lastScanTime:Date.now()};return t.forEach(o=>{e.threatsByType[o.type]||(e.threatsByType[o.type]=0),e.threatsByType[o.type]++}),t.forEach(o=>{e.threatsByLevel[o.level]||(e.threatsByLevel[o.level]=0),e.threatsByLevel[o.level]++}),e}),D=u(()=>{const t=new Date;t.setHours(0,0,0,0);const e=t.getTime();return B.value.filter(o=>o.blocked&&o.timestamp>=e).length}),E=u(()=>m.value>=90?"success":m.value>=70?"warning":"danger"),N=u(()=>m.value>=90?"å®‰å…¨":m.value>=70?"æ³¨æ„":"å±é™©");function q(t){return t>=90?"#67c23a":t>=70?"#e6a23c":"#f56c6c"}function F(t){return t>=90?"ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½":t>=70?"å­˜åœ¨ä¸€äº›å®‰å…¨é£é™©":"å‘ç°ä¸¥é‡å®‰å…¨é—®é¢˜"}function I(t){return{low:"#909399",medium:"#e6a23c",high:"#f56c6c",critical:"#f56c6c"}[t]||"#909399"}function O(t){return{malicious_url:"æ¶æ„URL",xss_attack:"XSSæ”»å‡»",tracker:"éšç§è¿½è¸ª",insecure_form:"ä¸å®‰å…¨è¡¨å•",suspicious_script:"å¯ç–‘è„šæœ¬",phishing:"é’“é±¼ç½‘ç«™"}[t]||"æœªçŸ¥å¨èƒ"}function W(t){const o=Date.now()-t,c=Math.floor(o/6e4);if(c<1)return"åˆšåˆš";if(c<60)return`${c}åˆ†é’Ÿå‰`;const d=Math.floor(c/60);return d<24?`${d}å°æ—¶å‰`:`${Math.floor(d/24)}å¤©å‰`}async function j(){P.value=!0;try{await n.scanCurrentPage()}catch(t){console.error("æ‰«æå¤±è´¥:",t)}finally{P.value=!1}}function X(){typeof chrome<"u"&&chrome.runtime&&chrome.runtime.openOptionsPage()}async function U(){try{await n.updateSettings(h.value)}catch(t){console.error("æ›´æ–°è®¾ç½®å¤±è´¥:",t)}}async function z(){try{if(typeof chrome<"u"&&chrome.tabs){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t.url&&(T.value=t.url,y.value=new URL(t.url).hostname,C.value=t.url.startsWith("https://"),await R(t.url))}}catch(t){console.error("è·å–é¡µé¢ä¿¡æ¯å¤±è´¥:",t),y.value="æ— æ³•è·å–"}}async function R(t){let e=100,o="";try{o=new URL(t).hostname}catch{o=t}n.stats;const c=n.recentThreats,d=c.filter(f=>{try{return new URL(f.url).hostname===o}catch{return f.url.includes(o)}});d.forEach(f=>{switch(f.level){case"critical":e-=30;break;case"high":e-=20;break;case"medium":e-=10;break;case"low":e-=5;break}});const b=t.includes("localhost")||t.includes("127.0.0.1");!t.startsWith("https://")&&!b&&(e-=15,console.log("âŒ æœªä½¿ç”¨HTTPSï¼Œæ‰£15åˆ†")),e=Math.max(0,Math.min(100,e)),n.currentPageAnalysis={url:t,score:e,threats:d,recommendations:e<90?["å‘ç°å®‰å…¨å¨èƒï¼Œå»ºè®®è°¨æ…æ“ä½œ"]:["ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½"],scanTime:Date.now(),isSecure:e>=90},console.log(`ğŸ” é¡µé¢å®‰å…¨è¯„åˆ†: ${e}`),console.log(`ğŸ“Š å½“å‰é¡µé¢å¨èƒ: ${d.length} / æ€»å¨èƒ: ${c.length}`)}function G(){typeof chrome<"u"&&chrome.storage&&chrome.storage.onChanged.addListener((t,e)=>{e==="local"&&(console.log("ğŸ“¦ Storage changed:",t),(t.security_stats||t.threat_history)&&(n.loadStats(),n.loadThreats(),T.value&&R(T.value)))})}function J(){typeof chrome<"u"&&chrome.tabs&&chrome.tabs.onActivated.addListener(async()=>{console.log("ğŸ”„ Tab switched, refreshing page info"),await z()})}return Y(async()=>{await n.initialize(),await z(),G(),J()}),(t,e)=>{const o=v("el-icon"),c=v("el-button"),d=v("el-badge"),b=v("el-progress"),f=v("el-tag"),w=v("el-switch");return p(),S("div",me,[s("div",he,[s("div",ve,[a(o,{size:"24",color:"#667eea"},{default:r(()=>[a(_(ee))]),_:1}),e[3]||(e[3]=s("h1",null,"å®‰å…¨å®ˆæŠ¤è€…",-1))]),s("div",pe,[a(d,{value:D.value,class:"badge"},{default:r(()=>[a(c,{type:x.value?"success":"danger",size:"small",circle:""},{default:r(()=>[a(o,null,{default:r(()=>[x.value?(p(),M(_(te),{key:0})):(p(),M(_(se),{key:1}))]),_:1})]),_:1},8,["type"])]),_:1},8,["value"])])]),s("div",_e,[a(b,{type:"circle",percentage:m.value,color:q(m.value),width:80},{default:r(({percentage:l})=>[s("span",ge,i(l),1)]),_:1},8,["percentage","color"]),s("div",ye,[e[4]||(e[4]=s("h3",null,"å®‰å…¨è¯„åˆ†",-1)),s("p",null,i(F(m.value)),1)])]),s("div",Te,[e[5]||(e[5]=s("h3",null,"å½“å‰é¡µé¢",-1)),s("div",be,[s("div",we,i(y.value),1),s("div",ke,[a(f,{type:C.value?"success":"warning",size:"small"},{default:r(()=>[g(i(C.value?"HTTPS":"HTTP"),1)]),_:1},8,["type"]),a(f,{type:E.value,size:"small"},{default:r(()=>[g(i(N.value),1)]),_:1},8,["type"])])])]),s("div",Se,[s("div",Le,[s("div",Pe,i(A.value.blockedThreats),1),e[6]||(e[6]=s("div",{class:"stat-label"},"å·²é˜»æ­¢å¨èƒ",-1))]),s("div",Ce,[s("div",Be,i(A.value.totalThreats),1),e[7]||(e[7]=s("div",{class:"stat-label"},"æ£€æµ‹åˆ°å¨èƒ",-1))]),s("div",Ue,[s("div",Ve,i(D.value),1),e[8]||(e[8]=s("div",{class:"stat-label"},"ä»Šæ—¥é˜»æ­¢",-1))])]),H.value.length>0?(p(),S("div",xe,[e[9]||(e[9]=s("h3",null,"æœ€è¿‘å¨èƒ",-1)),s("div",He,[(p(!0),S(oe,null,ae(H.value.slice(0,3),l=>(p(),S("div",{key:l.id,class:"threat-item"},[a(o,{color:I(l.level)},{default:r(()=>[a(_(re))]),_:1},8,["color"]),s("div",Ae,[s("div",De,i(O(l.type)),1),s("div",ze,i(W(l.timestamp)),1)]),a(f,{type:l.blocked?"success":"warning",size:"small"},{default:r(()=>[g(i(l.blocked?"å·²é˜»æ­¢":"å·²æ£€æµ‹"),1)]),_:2},1032,["type"])]))),128))])])):Z("",!0),s("div",Re,[a(c,{type:"primary",onClick:j,loading:P.value,style:{flex:"1"}},{default:r(()=>[a(o,null,{default:r(()=>[a(_(ne))]),_:1}),e[10]||(e[10]=g(" æ‰«æå½“å‰é¡µé¢ ",-1))]),_:1},8,["loading"]),a(c,{onClick:X},{default:r(()=>[a(o,null,{default:r(()=>[a(_(le))]),_:1}),e[11]||(e[11]=g(" è®¾ç½® ",-1))]),_:1})]),s("div",Me,[s("div",$e,[e[12]||(e[12]=s("span",null,"æ¶æ„URLé˜²æŠ¤",-1)),a(w,{modelValue:h.value.maliciousUrlProtection,"onUpdate:modelValue":e[0]||(e[0]=l=>h.value.maliciousUrlProtection=l),onChange:U},null,8,["modelValue"])]),s("div",Ee,[e[13]||(e[13]=s("span",null,"XSSé˜²æŠ¤",-1)),a(w,{modelValue:h.value.xssProtection,"onUpdate:modelValue":e[1]||(e[1]=l=>h.value.xssProtection=l),onChange:U},null,8,["modelValue"])]),s("div",Ne,[e[14]||(e[14]=s("span",null,"è¿½è¸ªå™¨é˜»æ­¢",-1)),a(w,{modelValue:h.value.trackerBlocking,"onUpdate:modelValue":e[2]||(e[2]=l=>h.value.trackerBlocking=l),onChange:U},null,8,["modelValue"])])])])}}}),Fe=ce(qe,[["__scopeId","data-v-dbd45056"]]),L=ie(Fe),Ie=ue();L.use(Ie);L.use(de);for(const[V,n]of Object.entries(fe))L.component(V,n);L.mount("#app");
