import{d as _e,u as be,r as v,c as _,o as we,g as T,a as x,h as g,b as o,j as V,e as a,f as l,v as h,x as Te,i as P,y as ke,z as $e,t as d,k as S,F as xe,l as Se,A as Pe,B as Z,C as Le,D as He,G as ee,H as te,I as oe,J as Ae,_ as ze,m as Ce,p as Re,q as Ie,s as Ue}from"./_plugin-vue_export-helper-DyC-ivGw.js";import"./security-6RDsp77e.js";const Be={class:"security-popup"},De={class:"header"},Ee={class:"logo"},Ve={class:"status"},qe={class:"security-score"},Me={class:"score-text"},Ne={class:"score-info"},We={class:"current-page"},Oe={class:"page-info"},je={class:"url"},Ke={class:"badges"},Xe={class:"stats"},Ge={class:"stat-item"},Fe={class:"stat-number"},Je={class:"stat-item"},Ye={class:"stat-number"},Qe={class:"stat-item"},Ze={class:"stat-number"},et={key:0,class:"recent-threats"},tt={class:"threat-list"},ot={class:"threat-info"},st={class:"threat-title"},at={class:"threat-time"},nt={class:"actions"},rt={class:"phishing-detector"},lt={class:"result-header"},it=["innerHTML"],ct={key:1,class:"analyzing-tips"},ut={class:"scan-result-container"},dt={class:"result-header"},mt=["innerHTML"],pt={class:"scan-info"},ft={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"8px 0"}},gt={style:{"font-size":"12px",color:"#666"}},ht={style:{"font-size":"12px",color:"#666"}},yt=_e({__name:"App",setup(K){const m=be(),B=v(!1),L=v("åŠ è½½ä¸­..."),M=v(!1),H=v(""),N=v(!1),A=v(""),z=v(""),C=v(!1),R=v(!0),I=v(!1),w=v(""),b=v(!0),X=_(()=>m.isActive),k=_(()=>m.securityScore);_(()=>m.settings);const se=_(()=>{try{return new URL(H.value).hostname}catch{return L.value}}),D=_(()=>{const t=se.value;return m.threats.filter(e=>{try{return new URL(e.url).hostname===t}catch{return e.url.includes(t)}})}),G=_(()=>D.value.slice(0,10)),F=_(()=>{const t=D.value,e={totalThreats:t.length,blockedThreats:t.filter(s=>s.blocked).length,allowedThreats:t.filter(s=>!s.blocked).length,threatsByType:{},threatsByLevel:{},lastScanTime:Date.now()};return t.forEach(s=>{e.threatsByType[s.type]||(e.threatsByType[s.type]=0),e.threatsByType[s.type]++}),t.forEach(s=>{e.threatsByLevel[s.level]||(e.threatsByLevel[s.level]=0),e.threatsByLevel[s.level]++}),e}),J=_(()=>{const t=new Date;t.setHours(0,0,0,0);const e=t.getTime();return D.value.filter(s=>s.blocked&&s.timestamp>=e).length}),ae=_(()=>k.value>=90?"success":k.value>=70?"warning":"danger"),ne=_(()=>k.value>=90?"å®‰å…¨":k.value>=70?"æ³¨æ„":"å±é™©"),re=_(()=>R.value?"safe":"danger"),le=_(()=>R.value?"âœ… ç½‘ç«™å®‰å…¨":"âš ï¸ ç–‘ä¼¼é’“é±¼ç½‘ç«™");function ie(t){return t>=90?"#67c23a":t>=70?"#e6a23c":"#f56c6c"}function ce(t){return t>=90?"ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½":t>=70?"å­˜åœ¨ä¸€äº›å®‰å…¨é£é™©":"å‘ç°ä¸¥é‡å®‰å…¨é—®é¢˜"}function ue(t){return{low:"#909399",medium:"#e6a23c",high:"#f56c6c",critical:"#f56c6c"}[t]||"#909399"}function Y(t){return{malicious_url:"æ¶æ„URL",xss_attack:"XSSæ”»å‡»",tracker:"éšç§è¿½è¸ª",insecure_form:"ä¸å®‰å…¨è¡¨å•",suspicious_script:"å¯ç–‘è„šæœ¬",phishing:"é’“é±¼ç½‘ç«™"}[t]||"æœªçŸ¥å¨èƒ"}function de(t){const s=Date.now()-t,i=Math.floor(s/6e4);if(i<1)return"åˆšåˆš";if(i<60)return`${i}åˆ†é’Ÿå‰`;const u=Math.floor(i/60);return u<24?`${u}å°æ—¶å‰`:`${Math.floor(u/24)}å¤©å‰`}const me=[{domain:"google.com",name:"Google",category:"æœç´¢å¼•æ“"},{domain:"bing.com",name:"Bing",category:"æœç´¢å¼•æ“"},{domain:"baidu.com",name:"ç™¾åº¦",category:"æœç´¢å¼•æ“"},{domain:"yahoo.com",name:"Yahoo",category:"æœç´¢å¼•æ“"},{domain:"facebook.com",name:"Facebook",category:"ç¤¾äº¤åª’ä½“"},{domain:"twitter.com",name:"Twitter",category:"ç¤¾äº¤åª’ä½“"},{domain:"x.com",name:"X (Twitter)",category:"ç¤¾äº¤åª’ä½“"},{domain:"instagram.com",name:"Instagram",category:"ç¤¾äº¤åª’ä½“"},{domain:"linkedin.com",name:"LinkedIn",category:"ç¤¾äº¤åª’ä½“"},{domain:"reddit.com",name:"Reddit",category:"ç¤¾äº¤åª’ä½“"},{domain:"weibo.com",name:"å¾®åš",category:"ç¤¾äº¤åª’ä½“"},{domain:"zhihu.com",name:"çŸ¥ä¹",category:"ç¤¾äº¤åª’ä½“"},{domain:"microsoft.com",name:"Microsoft",category:"ç§‘æŠ€å…¬å¸"},{domain:"apple.com",name:"Apple",category:"ç§‘æŠ€å…¬å¸"},{domain:"amazon.com",name:"Amazon",category:"ç”µå•†å¹³å°"},{domain:"github.com",name:"GitHub",category:"å¼€å‘å¹³å°"},{domain:"stackoverflow.com",name:"Stack Overflow",category:"å¼€å‘ç¤¾åŒº"},{domain:"youtube.com",name:"YouTube",category:"è§†é¢‘å¹³å°"},{domain:"bilibili.com",name:"Bilibili",category:"è§†é¢‘å¹³å°"},{domain:"netflix.com",name:"Netflix",category:"è§†é¢‘å¹³å°"},{domain:"bbc.com",name:"BBC",category:"æ–°é—»åª’ä½“"},{domain:"cnn.com",name:"CNN",category:"æ–°é—»åª’ä½“"},{domain:"nytimes.com",name:"New York Times",category:"æ–°é—»åª’ä½“"},{domain:"paypal.com",name:"PayPal",category:"æ”¯ä»˜å¹³å°"},{domain:"alipay.com",name:"æ”¯ä»˜å®",category:"æ”¯ä»˜å¹³å°"},{domain:"taobao.com",name:"æ·˜å®",category:"ç”µå•†å¹³å°"},{domain:"jd.com",name:"äº¬ä¸œ",category:"ç”µå•†å¹³å°"},{domain:"tmall.com",name:"å¤©çŒ«",category:"ç”µå•†å¹³å°"},{domain:"ebay.com",name:"eBay",category:"ç”µå•†å¹³å°"},{domain:"dropbox.com",name:"Dropbox",category:"äº‘å­˜å‚¨"},{domain:"icloud.com",name:"iCloud",category:"äº‘æœåŠ¡"},{domain:"wikipedia.org",name:"Wikipedia",category:"çŸ¥è¯†ç™¾ç§‘"},{domain:"coursera.org",name:"Coursera",category:"åœ¨çº¿æ•™è‚²"},{domain:"gmail.com",name:"Gmail",category:"é‚®ä»¶æœåŠ¡"},{domain:"outlook.com",name:"Outlook",category:"é‚®ä»¶æœåŠ¡"},{domain:"qq.com",name:"QQ",category:"é‚®ä»¶æœåŠ¡"},{domain:"npmjs.com",name:"npm",category:"åŒ…ç®¡ç†å™¨"},{domain:"docker.com",name:"Docker",category:"å®¹å™¨å¹³å°"}];function pe(t){try{const e=new URL(t).hostname.toLowerCase().replace(/^www\./,"");for(const s of me)if(e===s.domain||e.endsWith("."+s.domain))return{isTrusted:!0,info:s};return{isTrusted:!1}}catch{return{isTrusted:!1}}}async function fe(){B.value=!0,w.value="";try{if(typeof chrome>"u"||!chrome.tabs)throw new Error("æ— æ³•è®¿é—®æµè§ˆå™¨æ ‡ç­¾é¡µAPI");const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t.url)throw new Error("æ— æ³•è·å–å½“å‰é¡µé¢URL");console.log("ğŸ” å¼€å§‹æ‰«æé¡µé¢:",t.url);const e=pe(t.url);if(e.isTrusted&&e.info){const n=e.info;b.value=!0,w.value=`
        <div style="padding: 16px; background: linear-gradient(135deg, #67c23a22, #67c23a11); border-left: 4px solid #67c23a; border-radius: 8px; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <div style="font-size: 32px; font-weight: bold; color: #67c23a;">100</div>
            <div>
              <div style="font-size: 14px; font-weight: 600; color: #67c23a;">ç»¼åˆå®‰å…¨è¯„åˆ†</div>
              <div style="font-size: 12px; color: #666;">çŠ¶æ€ï¼šä¼˜ç§€ âœ… å®‰å…¨</div>
            </div>
          </div>
        </div>
        
        <h3 style="color: #67c23a; margin-top: 0;">âœ… å…¨çƒå…¬è®¤çš„å®˜æ–¹ç½‘ç«™</h3>
        
        <div style="background: #f0f9ff; padding: 12px; border-radius: 8px; margin: 12px 0;">
          <p style="margin: 4px 0;"><strong>ç½‘ç«™åç§°ï¼š</strong>${n.name}</p>
          <p style="margin: 4px 0;"><strong>ç½‘ç«™ç±»åˆ«ï¼š</strong>${n.category}</p>
          <p style="margin: 4px 0;"><strong>å®˜æ–¹åŸŸåï¼š</strong>${n.domain}</p>
          <p style="margin: 4px 0;"><strong>å½“å‰URLï¼š</strong>${t.url}</p>
        </div>
        
        <h4>ğŸ›¡ï¸ å®‰å…¨è¯„ä¼°</h4>
        <p><strong>âœ… åŸŸåè®¤è¯ï¼š</strong>è¯¥åŸŸåæ˜¯å…¨çƒå…¬è®¤çš„å®˜æ–¹ç½‘ç«™ï¼Œå¯ä¿¡åº¦æé«˜</p>
        <p><strong>âœ… å“ç‰Œè®¤è¯ï¼š</strong>${n.name} æ˜¯çŸ¥åçš„${n.category}å¹³å°</p>
        <p><strong>âœ… å®‰å…¨åè®®ï¼š</strong>${t.url.startsWith("https://")?"HTTPSåŠ å¯†è¿æ¥":"HTTPè¿æ¥ï¼ˆå»ºè®®ä½¿ç”¨HTTPSï¼‰"}</p>
        <p><strong>âœ… å¨èƒæ£€æµ‹ï¼š</strong>æœªæ£€æµ‹åˆ°ä»»ä½•å®‰å…¨å¨èƒ</p>
        
        <h4>ğŸ“‹ å®‰å…¨å»ºè®®</h4>
        <ul style="margin: 8px 0; padding-left: 24px;">
          <li>è¿™æ˜¯${n.name}çš„å®˜æ–¹ç½‘ç«™ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨</li>
          <li>è¯·ç¡®ä¿æ‚¨è®¿é—®çš„æ˜¯æ­£ç¡®çš„å®˜æ–¹åŸŸåï¼š${n.domain}</li>
          <li>æ³¨æ„ä¿æŠ¤æ‚¨çš„è´¦å·å¯†ç ï¼Œä¸è¦ä¸ä»–äººåˆ†äº«</li>
          ${t.url.startsWith("https://")?"":'<li style="color: #e6a23c;">âš ï¸ å»ºè®®ä½¿ç”¨HTTPSè®¿é—®ä»¥ç¡®ä¿æ•°æ®å®‰å…¨</li>'}
        </ul>
        
        <div style="margin-top: 16px; padding: 12px; background: #f8f9fa; border-radius: 8px; font-size: 12px; color: #666;">
          <p style="margin: 0;">âœ… æ­¤ç½‘ç«™å·²é€šè¿‡å®˜æ–¹åŸŸåéªŒè¯ï¼Œå±äºå¯ä¿¡ä»»çš„çŸ¥åå¹³å°</p>
        </div>
      `,I.value=!0,B.value=!1,console.log("âœ… è¯†åˆ«ä¸ºå®˜æ–¹ç½‘ç«™ï¼Œç›´æ¥è¿”å›å®‰å…¨ç»“æœ");return}let s="";try{const n=await chrome.scripting.executeScript({target:{tabId:t.id},func:()=>({title:document.title,url:window.location.href,forms:document.querySelectorAll("form").length,links:document.querySelectorAll("a").length,scripts:document.querySelectorAll("script").length,iframes:document.querySelectorAll("iframe").length,inputs:document.querySelectorAll('input[type="password"], input[type="email"], input[type="text"]').length,hasHttps:window.location.protocol==="https:",metaDescription:document.querySelector('meta[name="description"]')?.getAttribute("content")||"",suspiciousElements:{hiddenIframes:document.querySelectorAll('iframe[style*="display:none"], iframe[style*="visibility:hidden"]').length,externalScripts:Array.from(document.querySelectorAll("script[src]")).filter(O=>{const E=O.src;return E&&!E.includes(window.location.hostname)}).length,popupScripts:document.body.innerHTML.includes("window.open")?1:0}})});if(n&&n[0]?.result){const r=n[0].result;s=`
é¡µé¢æ ‡é¢˜: ${r.title}
é¡µé¢URL: ${r.url}
åè®®: ${r.hasHttps?"HTTPS (å®‰å…¨)":"HTTP (ä¸å®‰å…¨)"}

é¡µé¢å…ƒç´ ç»Ÿè®¡:
- è¡¨å•æ•°é‡: ${r.forms}
- é“¾æ¥æ•°é‡: ${r.links}
- è„šæœ¬æ•°é‡: ${r.scripts}
- iframeæ•°é‡: ${r.iframes}
- è¾“å…¥æ¡†æ•°é‡: ${r.inputs}

å¯ç–‘å…ƒç´ :
- éšè—iframe: ${r.suspiciousElements.hiddenIframes}
- å¤–éƒ¨è„šæœ¬: ${r.suspiciousElements.externalScripts}
- å¼¹çª—è„šæœ¬: ${r.suspiciousElements.popupScripts}

é¡µé¢æè¿°: ${r.metaDescription||"æ— "}
        `.trim()}}catch(n){console.warn("æ— æ³•è·å–é¡µé¢å†…å®¹ï¼Œä»…ä½¿ç”¨URLåˆ†æ:",n),s=`é¡µé¢URL: ${t.url}
åè®®: ${t.url.startsWith("https://")?"HTTPS (å®‰å…¨)":"HTTP (ä¸å®‰å…¨)"}`}const i=D.value;let u="";i.length>0?(u=`

æ£€æµ‹åˆ°çš„å¨èƒ (${i.length}æ¡):
`,i.slice(0,5).forEach((n,r)=>{u+=`${r+1}. ${Y(n.type)} - ${n.level}çº§åˆ« - ${n.description}
`})):u=`

å½“å‰æœªæ£€æµ‹åˆ°å¨èƒã€‚`;const p=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer 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","HTTP-Referer":"https://github.com/web-security-guardian","X-Title":"Web Security Guardian","Content-Type":"application/json"},body:JSON.stringify({model:"tngtech/deepseek-r1t2-chimera:free",messages:[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªç½‘ç»œå®‰å…¨ä¸“å®¶ï¼Œä¸“é—¨åˆ†æç½‘é¡µå®‰å…¨æ€§ã€‚è¯·å…¨é¢åˆ†ææä¾›çš„é¡µé¢ä¿¡æ¯ï¼Œè¯„ä¼°å®‰å…¨é£é™©ï¼Œå¹¶ç»™å‡ºä¸“ä¸šå»ºè®®ã€‚å›ç­”è¦è¯¦ç»†ä¸”ç»“æ„åŒ–ï¼ŒåŒ…å«ï¼š1.æ•´ä½“å®‰å…¨è¯„ä¼° 2.å‘ç°çš„é£é™©ç‚¹ 3.å®‰å…¨å»ºè®®ã€‚ç”¨ä¸­æ–‡å›ç­”ã€‚è¯„åˆ†æ ‡å‡†ï¼š65åˆ†åŠä»¥ä¸Šä¸ºå®‰å…¨ï¼Œ65åˆ†ä»¥ä¸‹éœ€æ³¨æ„é£é™©ã€‚"},{role:"user",content:`è¯·å¯¹ä»¥ä¸‹ç½‘é¡µè¿›è¡Œå…¨é¢çš„å®‰å…¨åˆ†æï¼š

${s}
${u}

è¯·ä»ä»¥ä¸‹è§’åº¦è¿›è¡Œåˆ†æï¼š
1. URLå’ŒåŸŸåå®‰å…¨æ€§
2. åè®®å®‰å…¨ï¼ˆHTTPS/HTTPï¼‰
3. é¡µé¢å…ƒç´ é£é™©è¯„ä¼°ï¼ˆè¡¨å•ã€è„šæœ¬ã€iframeç­‰ï¼‰
4. æ£€æµ‹åˆ°çš„å®‰å…¨å¨èƒåˆ†æ
5. å¯ç–‘è¡Œä¸ºè¯†åˆ«
6. **ç»¼åˆå®‰å…¨è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰**ã€å¿…é¡»æ˜ç¡®ç»™å‡ºè¯„åˆ†ï¼Œæ ¼å¼ï¼šç»¼åˆå®‰å…¨è¯„åˆ†ï¼šXXåˆ†ã€‘
7. å…·ä½“å®‰å…¨å»ºè®®

è¯„åˆ†æ ‡å‡†è¯´æ˜ï¼š
- 90-100åˆ†ï¼šä¼˜ç§€ï¼Œéå¸¸å®‰å…¨
- 80-89åˆ†ï¼šè‰¯å¥½ï¼Œå®‰å…¨å¯é 
- 65-79åˆ†ï¼šåˆæ ¼ï¼Œæ•´ä½“å®‰å…¨
- 50-64åˆ†ï¼šä¸€èˆ¬ï¼Œå­˜åœ¨é£é™©
- 0-49åˆ†ï¼šè¾ƒå·®ï¼Œæœ‰æ˜æ˜¾å®‰å…¨é—®é¢˜

è¯·ç»™å‡ºè¯¦ç»†çš„åˆ†ææŠ¥å‘Šï¼Œå¹¶åœ¨æŠ¥å‘Šä¸­æ˜ç¡®æ ‡æ³¨"ç»¼åˆå®‰å…¨è¯„åˆ†ï¼šXXåˆ†"ã€‚`}]})});if(!p.ok)throw new Error(`APIè¯·æ±‚å¤±è´¥: ${p.status}`);const y=(await p.json()).choices[0].message.content;console.log("ğŸ¤– AIåˆ†æç»“æœ:",y);let f=-1;const c=[/ç»¼åˆå®‰å…¨è¯„åˆ†[ï¼š:]\s*(\d+)\s*åˆ†/i,/å®‰å…¨è¯„åˆ†[ï¼š:]\s*(\d+)\s*åˆ†/i,/è¯„åˆ†[ï¼š:]\s*(\d+)\s*[åˆ†\/]/i,/(\d+)\s*åˆ†\s*\(0-100\)/i,/å¾—åˆ†[ï¼š:]\s*(\d+)/i,/åˆ†æ•°[ï¼š:]\s*(\d+)/i];for(const n of c){const r=y.match(n);if(r&&r[1]){f=parseInt(r[1]),console.log("ğŸ“Š æå–åˆ°è¯„åˆ†:",f);break}}if(f>=0)b.value=f>=65,console.log(`âœ… æ ¹æ®è¯„åˆ†åˆ¤æ–­: ${f}åˆ† - ${b.value?"å®‰å…¨":"å±é™©"}`);else{const n=["å±é™©","é«˜é£é™©","ä¸¥é‡å¨èƒ","ä¸å®‰å…¨","æ¶æ„","é’“é±¼"],r=["å®‰å…¨","å¯ä¿¡","æ­£å¸¸","æ— é£é™©","ä½é£é™©"],O=n.some(j=>y.includes(j)),E=r.some(j=>y.includes(j));b.value=E&&!O,console.log("âš ï¸ æœªæ‰¾åˆ°è¯„åˆ†ï¼Œä½¿ç”¨å…³é”®è¯åˆ¤æ–­:",b.value?"å®‰å…¨":"å±é™©")}if(w.value=y.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/###\s*(.*?)(<br>|$)/g,"<h4>$1</h4>").replace(/##\s*(.*?)(<br>|$)/g,"<h3>$1</h3>"),f>=0){const n=f>=80?"#67c23a":f>=65?"#e6a23c":"#f56c6c",r=f>=80?"ä¼˜ç§€":f>=65?"è‰¯å¥½":"éœ€æ³¨æ„";w.value=`
        <div style="padding: 12px; background: linear-gradient(135deg, ${n}22, ${n}11); border-left: 4px solid ${n}; border-radius: 8px; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 12px;">
            <div style="font-size: 32px; font-weight: bold; color: ${n};">${f}</div>
            <div>
              <div style="font-size: 14px; font-weight: 600; color: ${n};">ç»¼åˆå®‰å…¨è¯„åˆ†</div>
              <div style="font-size: 12px; color: #666;">çŠ¶æ€ï¼š${r} ${f>=65?"âœ… å®‰å…¨":"âš ï¸ éœ€æ³¨æ„"}</div>
            </div>
          </div>
        </div>
        ${w.value}
      `}I.value=!0,console.log("âœ… é¡µé¢æ‰«æå®Œæˆ")}catch(t){console.error("æ‰«æå¤±è´¥:",t),w.value=`<p style="color: #f56c6c;">âŒ æ‰«æå¤±è´¥: ${t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯"}</p><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`,b.value=!0,I.value=!0}finally{B.value=!1}}function ge(){typeof chrome<"u"&&chrome.runtime&&chrome.runtime.openOptionsPage()}async function he(){if(A.value.trim()){C.value=!0,z.value="";try{const e=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer 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","HTTP-Referer":"https://github.com/web-security-guardian","X-Title":"Web Security Guardian","Content-Type":"application/json"},body:JSON.stringify({model:"tngtech/deepseek-r1t2-chimera:free",messages:[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªç½‘ç»œå®‰å…¨ä¸“å®¶ï¼Œä¸“é—¨è¯†åˆ«é’“é±¼ç½‘ç«™ã€‚è¯·åˆ†æç”¨æˆ·æä¾›çš„URLï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ã€‚å›ç­”è¦ç®€æ´æ˜äº†ï¼ŒåŒ…å«ï¼š1.åˆ¤æ–­ç»“æœï¼ˆå®‰å…¨/å±é™©ï¼‰2.ä¸»è¦åŸå›  3.é£é™©ç­‰çº§ã€‚ç”¨ä¸­æ–‡å›ç­”ï¼Œæ ¼å¼æ¸…æ™°ã€‚"},{role:"user",content:`è¯·åˆ†æè¿™ä¸ªç½‘å€æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ï¼š${A.value}

è¯·ä»ä»¥ä¸‹æ–¹é¢åˆ†æï¼š
1. åŸŸåç‰¹å¾ï¼ˆæ˜¯å¦ä»¿å†’çŸ¥åç½‘ç«™ï¼‰
2. URLç»“æ„ï¼ˆæ˜¯å¦æœ‰å¼‚å¸¸å­—ç¬¦æˆ–ç¼–ç ï¼‰
3. é¡¶çº§åŸŸåå¯ä¿¡åº¦
4. æ˜¯å¦åŒ…å«å¯ç–‘å…³é”®è¯
5. ç»¼åˆå®‰å…¨è¯„ä¼°`}]})});if(!e.ok)throw new Error(`APIè¯·æ±‚å¤±è´¥: ${e.status}`);const i=(await e.json()).choices[0].message.content,u=["å±é™©","é’“é±¼","ä¸å®‰å…¨","é£é™©","å¯ç–‘","ä»¿å†’","æ¬ºè¯ˆ"],$=["å®‰å…¨","æ­£å¸¸","å¯ä¿¡","åˆæ³•"],p=u.some(y=>i.includes(y)),U=$.some(y=>i.includes(y));R.value=!p||U&&!i.includes("é«˜é£é™©"),z.value=i.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/###\s*(.*?)(<br>|$)/g,"<h4>$1</h4>")}catch(t){console.error("AIæ£€æµ‹å¤±è´¥:",t),z.value=`<p style="color: #f56c6c;">âŒ æ£€æµ‹å¤±è´¥: ${t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯"}</p><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`,R.value=!0}finally{C.value=!1}}}async function Q(){try{if(typeof chrome<"u"&&chrome.tabs){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t.url&&(H.value=t.url,L.value=new URL(t.url).hostname,M.value=t.url.startsWith("https://"),await W(t.url))}}catch(t){console.error("è·å–é¡µé¢ä¿¡æ¯å¤±è´¥:",t),L.value="æ— æ³•è·å–"}}async function W(t){let e=100,s="";try{s=new URL(t).hostname}catch{s=t}m.stats;const i=m.recentThreats,u=i.filter(p=>{try{return new URL(p.url).hostname===s}catch{return p.url.includes(s)}});u.forEach(p=>{switch(p.level){case"critical":e-=30;break;case"high":e-=20;break;case"medium":e-=10;break;case"low":e-=5;break}});const $=t.includes("localhost")||t.includes("127.0.0.1");!t.startsWith("https://")&&!$&&(e-=15,console.log("âŒ æœªä½¿ç”¨HTTPSï¼Œæ‰£15åˆ†")),e=Math.max(0,Math.min(100,e)),m.currentPageAnalysis={url:t,score:e,threats:u,recommendations:e<90?["å‘ç°å®‰å…¨å¨èƒï¼Œå»ºè®®è°¨æ…æ“ä½œ"]:["ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½"],scanTime:Date.now(),isSecure:e>=90},console.log(`ğŸ” é¡µé¢å®‰å…¨è¯„åˆ†: ${e}`),console.log(`ğŸ“Š å½“å‰é¡µé¢å¨èƒ: ${u.length} / æ€»å¨èƒ: ${i.length}`)}function ye(){typeof chrome<"u"&&chrome.storage&&chrome.storage.onChanged.addListener((t,e)=>{e==="local"&&(console.log("ğŸ“¦ Storage changed:",t),(t.security_stats||t.threat_history)&&(m.loadStats(),m.loadThreats(),H.value&&W(H.value)))})}function ve(){typeof chrome<"u"&&chrome.tabs&&chrome.tabs.onActivated.addListener(async()=>{console.log("ğŸ”„ Tab switched, refreshing page info"),await Q()})}return we(async()=>{console.log("ğŸ¨ Popup opened"),await m.initialize(),await Q(),ye(),ve(),setInterval(async()=>{await m.loadStats(),await m.loadThreats(),await W(H.value)},2e3)}),(t,e)=>{const s=T("el-icon"),i=T("el-button"),u=T("el-badge"),$=T("el-progress"),p=T("el-tag"),U=T("el-input"),y=T("el-dialog"),f=T("el-divider");return g(),x("div",Be,[o("div",De,[o("div",Ee,[a(s,{size:"24",color:"#667eea"},{default:l(()=>[a(h(Te))]),_:1}),e[4]||(e[4]=o("h1",null,"å®‰å…¨å®ˆæŠ¤è€…",-1))]),o("div",Ve,[a(u,{value:J.value,class:"badge"},{default:l(()=>[a(i,{type:X.value?"success":"danger",size:"small",circle:""},{default:l(()=>[a(s,null,{default:l(()=>[X.value?(g(),P(h(ke),{key:0})):(g(),P(h($e),{key:1}))]),_:1})]),_:1},8,["type"])]),_:1},8,["value"])])]),o("div",qe,[a($,{type:"circle",percentage:k.value,color:ie(k.value),width:80},{default:l(({percentage:c})=>[o("span",Me,d(c),1)]),_:1},8,["percentage","color"]),o("div",Ne,[e[5]||(e[5]=o("h3",null,"å®‰å…¨è¯„åˆ†",-1)),o("p",null,d(ce(k.value)),1)])]),o("div",We,[e[6]||(e[6]=o("h3",null,"å½“å‰é¡µé¢",-1)),o("div",Oe,[o("div",je,d(L.value),1),o("div",Ke,[a(p,{type:M.value?"success":"warning",size:"small"},{default:l(()=>[S(d(M.value?"HTTPS":"HTTP"),1)]),_:1},8,["type"]),a(p,{type:ae.value,size:"small"},{default:l(()=>[S(d(ne.value),1)]),_:1},8,["type"])])])]),o("div",Xe,[o("div",Ge,[o("div",Fe,d(F.value.blockedThreats),1),e[7]||(e[7]=o("div",{class:"stat-label"},"å·²é˜»æ­¢å¨èƒ",-1))]),o("div",Je,[o("div",Ye,d(F.value.totalThreats),1),e[8]||(e[8]=o("div",{class:"stat-label"},"æ£€æµ‹åˆ°å¨èƒ",-1))]),o("div",Qe,[o("div",Ze,d(J.value),1),e[9]||(e[9]=o("div",{class:"stat-label"},"ä»Šæ—¥é˜»æ­¢",-1))])]),G.value.length>0?(g(),x("div",et,[e[10]||(e[10]=o("h3",null,"æœ€è¿‘å¨èƒ",-1)),o("div",tt,[(g(!0),x(xe,null,Se(G.value.slice(0,3),c=>(g(),x("div",{key:c.id,class:"threat-item"},[a(s,{color:ue(c.level)},{default:l(()=>[a(h(Z))]),_:1},8,["color"]),o("div",ot,[o("div",st,d(Y(c.type)),1),o("div",at,d(de(c.timestamp)),1)]),a(p,{type:c.blocked?"success":"warning",size:"small"},{default:l(()=>[S(d(c.blocked?"å·²é˜»æ­¢":"å·²æ£€æµ‹"),1)]),_:2},1032,["type"])]))),128))])])):V("",!0),o("div",nt,[a(i,{type:"primary",onClick:fe,loading:B.value,style:{flex:"1"}},{default:l(()=>[a(s,null,{default:l(()=>[a(h(Pe))]),_:1}),e[11]||(e[11]=S(" æ‰«æå½“å‰é¡µé¢ ",-1))]),_:1},8,["loading"]),a(i,{onClick:e[0]||(e[0]=c=>N.value=!0),type:"warning"},{default:l(()=>[a(s,null,{default:l(()=>[a(h(Z))]),_:1}),e[12]||(e[12]=S(" AIæ£€æµ‹ ",-1))]),_:1}),a(i,{onClick:ge},{default:l(()=>[a(s,null,{default:l(()=>[a(h(Le))]),_:1}),e[13]||(e[13]=S(" è®¾ç½® ",-1))]),_:1})]),a(y,{modelValue:N.value,"onUpdate:modelValue":e[2]||(e[2]=c=>N.value=c),title:"é’“é±¼ç½‘ç«™æ£€æµ‹",width:"90%","close-on-click-modal":!1},{default:l(()=>[o("div",rt,[a(U,{modelValue:A.value,"onUpdate:modelValue":e[1]||(e[1]=c=>A.value=c),placeholder:"è¾“å…¥è¦æ£€æµ‹çš„ç½‘å€ï¼Œä¾‹å¦‚: https://example.com",size:"large",clearable:""},{prepend:l(()=>[a(s,null,{default:l(()=>[a(h(He))]),_:1})]),_:1},8,["modelValue"]),a(i,{type:"primary",onClick:he,loading:C.value,disabled:!A.value.trim(),style:{width:"100%","margin-top":"12px"},size:"large"},{default:l(()=>[S(d(C.value?"åˆ†æä¸­...":"å¼€å§‹æ£€æµ‹"),1)]),_:1},8,["loading","disabled"]),z.value?(g(),x("div",{key:0,class:ee(["result-box",re.value])},[o("div",lt,[a(s,{size:"24"},{default:l(()=>[R.value?(g(),P(h(te),{key:0})):(g(),P(h(oe),{key:1}))]),_:1}),o("h3",null,d(le.value),1)]),o("div",{class:"result-content",innerHTML:z.value},null,8,it)],2)):V("",!0),C.value?(g(),x("div",ct,[a(s,{class:"is-loading"},{default:l(()=>[a(h(Ae))]),_:1}),e[14]||(e[14]=o("p",null,"AIæ­£åœ¨åˆ†æç½‘å€ç‰¹å¾ï¼Œè¯·ç¨å€™...",-1))])):V("",!0)])]),_:1},8,["modelValue"]),a(y,{modelValue:I.value,"onUpdate:modelValue":e[3]||(e[3]=c=>I.value=c),title:"ğŸ” AIé¡µé¢å®‰å…¨æ‰«ææŠ¥å‘Š",width:"90%","close-on-click-modal":!1},{default:l(()=>[o("div",ut,[w.value?(g(),x("div",{key:0,class:ee(["result-box",b.value?"safe":"danger"])},[o("div",dt,[a(s,{size:"24"},{default:l(()=>[b.value?(g(),P(h(te),{key:0})):(g(),P(h(oe),{key:1}))]),_:1}),o("h3",null,d(b.value?"âœ… é¡µé¢æ•´ä½“å®‰å…¨":"âš ï¸ å‘ç°å®‰å…¨é£é™©"),1)]),o("div",{class:"result-content",innerHTML:w.value},null,8,mt)],2)):V("",!0),o("div",pt,[a(f),o("div",ft,[o("span",gt," æ‰«ææ—¶é—´: "+d(new Date().toLocaleString("zh-CN")),1),o("span",ht," å½“å‰é¡µé¢: "+d(L.value),1)])])])]),_:1},8,["modelValue"])])}}}),vt=ze(yt,[["__scopeId","data-v-f9740c8e"]]),q=Ce(vt),_t=Re();q.use(_t);q.use(Ie);for(const[K,m]of Object.entries(Ue))q.component(K,m);q.mount("#app");
