import{d as _e,u as be,r as h,c as y,o as we,g as T,a as $,h as p,b as a,j as D,e as n,f as l,v as g,x as Te,i as S,y as ke,z as $e,t as u,k as x,F as xe,l as Se,A as Pe,B as Q,C as Le,D as He,G as Z,H as ee,I as te,J as Ae,_ as ze,m as Ce,p as Re,q as Ie,s as Ue}from"./_plugin-vue_export-helper-DyC-ivGw.js";import"./security-6RDsp77e.js";const Be={class:"security-popup"},De={class:"header"},Ee={class:"logo"},Ve={class:"status"},qe={class:"security-score"},Me={class:"score-text"},Ne={class:"score-info"},Oe={class:"current-page"},We={class:"page-info"},je={class:"url"},Xe={class:"badges"},Ge={class:"stats"},Ke={class:"stat-item"},Fe={class:"stat-number"},Ye={class:"stat-item"},Je={class:"stat-number"},Qe={class:"stat-item"},Ze={class:"stat-number"},et={key:0,class:"recent-threats"},tt={class:"threat-list"},ot={class:"threat-info"},st={class:"threat-title"},at={class:"threat-time"},nt={class:"actions"},rt={class:"phishing-detector"},lt={class:"result-header"},it=["innerHTML"],ct={key:1,class:"analyzing-tips"},ut={class:"scan-result-container"},dt={class:"result-header"},mt=["innerHTML"],pt={class:"scan-info"},gt={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"8px 0"}},ft={style:{"font-size":"12px",color:"#666"}},ht={style:{"font-size":"12px",color:"#666"}},oe="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",yt=_e({__name:"App",setup(j){const m=be(),I=h(!1),P=h("åŠ è½½ä¸­..."),V=h(!1),L=h(""),q=h(!1),H=h(""),A=h(""),z=h(!1),C=h(!0),R=h(!1),w=h(""),b=h(!0),X=y(()=>m.isActive),k=y(()=>m.securityScore);y(()=>m.settings);const se=y(()=>{try{return new URL(L.value).hostname}catch{return P.value}}),U=y(()=>{const t=se.value;return m.threats.filter(e=>{try{return new URL(e.url).hostname===t}catch{return e.url.includes(t)}})}),G=y(()=>U.value.slice(0,10)),K=y(()=>{const t=U.value,e={totalThreats:t.length,blockedThreats:t.filter(o=>o.blocked).length,allowedThreats:t.filter(o=>!o.blocked).length,threatsByType:{},threatsByLevel:{},lastScanTime:Date.now()};return t.forEach(o=>{e.threatsByType[o.type]||(e.threatsByType[o.type]=0),e.threatsByType[o.type]++}),t.forEach(o=>{e.threatsByLevel[o.level]||(e.threatsByLevel[o.level]=0),e.threatsByLevel[o.level]++}),e}),F=y(()=>{const t=new Date;t.setHours(0,0,0,0);const e=t.getTime();return U.value.filter(o=>o.blocked&&o.timestamp>=e).length}),ae=y(()=>k.value>=90?"success":k.value>=70?"warning":"danger"),ne=y(()=>k.value>=90?"å®‰å…¨":k.value>=70?"æ³¨æ„":"å±é™©"),re=y(()=>C.value?"safe":"danger"),le=y(()=>C.value?"âœ… ç½‘ç«™å®‰å…¨":"âš ï¸ ç–‘ä¼¼é’“é±¼ç½‘ç«™");function ie(t){return t>=90?"#67c23a":t>=70?"#e6a23c":"#f56c6c"}function ce(t){return t>=90?"ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½":t>=70?"å­˜åœ¨ä¸€äº›å®‰å…¨é£é™©":"å‘ç°ä¸¥é‡å®‰å…¨é—®é¢˜"}function ue(t){return{low:"#909399",medium:"#e6a23c",high:"#f56c6c",critical:"#f56c6c"}[t]||"#909399"}function Y(t){return{malicious_url:"æ¶æ„URL",xss_attack:"XSSæ”»å‡»",tracker:"éšç§è¿½è¸ª",insecure_form:"ä¸å®‰å…¨è¡¨å•",suspicious_script:"å¯ç–‘è„šæœ¬",phishing:"é’“é±¼ç½‘ç«™"}[t]||"æœªçŸ¥å¨èƒ"}function de(t){const o=Date.now()-t,i=Math.floor(o/6e4);if(i<1)return"åˆšåˆš";if(i<60)return`${i}åˆ†é’Ÿå‰`;const c=Math.floor(i/60);return c<24?`${c}å°æ—¶å‰`:`${Math.floor(c/24)}å¤©å‰`}const me=[{domain:"google.com",name:"Google",category:"æœç´¢å¼•æ“"},{domain:"bing.com",name:"Bing",category:"æœç´¢å¼•æ“"},{domain:"baidu.com",name:"ç™¾åº¦",category:"æœç´¢å¼•æ“"},{domain:"yahoo.com",name:"Yahoo",category:"æœç´¢å¼•æ“"},{domain:"facebook.com",name:"Facebook",category:"ç¤¾äº¤åª’ä½“"},{domain:"twitter.com",name:"Twitter",category:"ç¤¾äº¤åª’ä½“"},{domain:"x.com",name:"X (Twitter)",category:"ç¤¾äº¤åª’ä½“"},{domain:"instagram.com",name:"Instagram",category:"ç¤¾äº¤åª’ä½“"},{domain:"linkedin.com",name:"LinkedIn",category:"ç¤¾äº¤åª’ä½“"},{domain:"reddit.com",name:"Reddit",category:"ç¤¾äº¤åª’ä½“"},{domain:"weibo.com",name:"å¾®åš",category:"ç¤¾äº¤åª’ä½“"},{domain:"zhihu.com",name:"çŸ¥ä¹",category:"ç¤¾äº¤åª’ä½“"},{domain:"microsoft.com",name:"Microsoft",category:"ç§‘æŠ€å…¬å¸"},{domain:"apple.com",name:"Apple",category:"ç§‘æŠ€å…¬å¸"},{domain:"amazon.com",name:"Amazon",category:"ç”µå•†å¹³å°"},{domain:"github.com",name:"GitHub",category:"å¼€å‘å¹³å°"},{domain:"stackoverflow.com",name:"Stack Overflow",category:"å¼€å‘ç¤¾åŒº"},{domain:"youtube.com",name:"YouTube",category:"è§†é¢‘å¹³å°"},{domain:"bilibili.com",name:"Bilibili",category:"è§†é¢‘å¹³å°"},{domain:"netflix.com",name:"Netflix",category:"è§†é¢‘å¹³å°"},{domain:"bbc.com",name:"BBC",category:"æ–°é—»åª’ä½“"},{domain:"cnn.com",name:"CNN",category:"æ–°é—»åª’ä½“"},{domain:"nytimes.com",name:"New York Times",category:"æ–°é—»åª’ä½“"},{domain:"paypal.com",name:"PayPal",category:"æ”¯ä»˜å¹³å°"},{domain:"alipay.com",name:"æ”¯ä»˜å®",category:"æ”¯ä»˜å¹³å°"},{domain:"taobao.com",name:"æ·˜å®",category:"ç”µå•†å¹³å°"},{domain:"jd.com",name:"äº¬ä¸œ",category:"ç”µå•†å¹³å°"},{domain:"tmall.com",name:"å¤©çŒ«",category:"ç”µå•†å¹³å°"},{domain:"ebay.com",name:"eBay",category:"ç”µå•†å¹³å°"},{domain:"dropbox.com",name:"Dropbox",category:"äº‘å­˜å‚¨"},{domain:"icloud.com",name:"iCloud",category:"äº‘æœåŠ¡"},{domain:"wikipedia.org",name:"Wikipedia",category:"çŸ¥è¯†ç™¾ç§‘"},{domain:"coursera.org",name:"Coursera",category:"åœ¨çº¿æ•™è‚²"},{domain:"gmail.com",name:"Gmail",category:"é‚®ä»¶æœåŠ¡"},{domain:"outlook.com",name:"Outlook",category:"é‚®ä»¶æœåŠ¡"},{domain:"qq.com",name:"QQ",category:"é‚®ä»¶æœåŠ¡"},{domain:"npmjs.com",name:"npm",category:"åŒ…ç®¡ç†å™¨"},{domain:"docker.com",name:"Docker",category:"å®¹å™¨å¹³å°"}];function pe(t){try{const e=new URL(t).hostname.toLowerCase().replace(/^www\./,"");for(const o of me)if(e===o.domain||e.endsWith("."+o.domain))return{isTrusted:!0,info:o};return{isTrusted:!1}}catch{return{isTrusted:!1}}}async function ge(){I.value=!0,w.value="";try{if(typeof chrome>"u"||!chrome.tabs)throw new Error("æ— æ³•è®¿é—®æµè§ˆå™¨æ ‡ç­¾é¡µAPI");const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t.url)throw new Error("æ— æ³•è·å–å½“å‰é¡µé¢URL");console.log("ğŸ” å¼€å§‹æ‰«æé¡µé¢:",t.url);const e=pe(t.url);if(e.isTrusted&&e.info){const s=e.info;b.value=!0,w.value=`
        <div style="padding: 16px; background: linear-gradient(135deg, #67c23a22, #67c23a11); border-left: 4px solid #67c23a; border-radius: 8px; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <div style="font-size: 32px; font-weight: bold; color: #67c23a;">100</div>
            <div>
              <div style="font-size: 14px; font-weight: 600; color: #67c23a;">ç»¼åˆå®‰å…¨è¯„åˆ†</div>
              <div style="font-size: 12px; color: #666;">çŠ¶æ€ï¼šä¼˜ç§€ âœ… å®‰å…¨</div>
            </div>
          </div>
        </div>
        
        <h3 style="color: #67c23a; margin-top: 0;">âœ… å…¨çƒå…¬è®¤çš„å®˜æ–¹ç½‘ç«™</h3>
        
        <div style="background: #f0f9ff; padding: 12px; border-radius: 8px; margin: 12px 0;">
          <p style="margin: 4px 0;"><strong>ç½‘ç«™åç§°ï¼š</strong>${s.name}</p>
          <p style="margin: 4px 0;"><strong>ç½‘ç«™ç±»åˆ«ï¼š</strong>${s.category}</p>
          <p style="margin: 4px 0;"><strong>å®˜æ–¹åŸŸåï¼š</strong>${s.domain}</p>
          <p style="margin: 4px 0;"><strong>å½“å‰URLï¼š</strong>${t.url}</p>
        </div>
        
        <h4>ğŸ›¡ï¸ å®‰å…¨è¯„ä¼°</h4>
        <p><strong>âœ… åŸŸåè®¤è¯ï¼š</strong>è¯¥åŸŸåæ˜¯å…¨çƒå…¬è®¤çš„å®˜æ–¹ç½‘ç«™ï¼Œå¯ä¿¡åº¦æé«˜</p>
        <p><strong>âœ… å“ç‰Œè®¤è¯ï¼š</strong>${s.name} æ˜¯çŸ¥åçš„${s.category}å¹³å°</p>
        <p><strong>âœ… å®‰å…¨åè®®ï¼š</strong>${t.url.startsWith("https://")?"HTTPSåŠ å¯†è¿æ¥":"HTTPè¿æ¥ï¼ˆå»ºè®®ä½¿ç”¨HTTPSï¼‰"}</p>
        <p><strong>âœ… å¨èƒæ£€æµ‹ï¼š</strong>æœªæ£€æµ‹åˆ°ä»»ä½•å®‰å…¨å¨èƒ</p>
        
        <h4>ğŸ“‹ å®‰å…¨å»ºè®®</h4>
        <ul style="margin: 8px 0; padding-left: 24px;">
          <li>è¿™æ˜¯${s.name}çš„å®˜æ–¹ç½‘ç«™ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨</li>
          <li>è¯·ç¡®ä¿æ‚¨è®¿é—®çš„æ˜¯æ­£ç¡®çš„å®˜æ–¹åŸŸåï¼š${s.domain}</li>
          <li>æ³¨æ„ä¿æŠ¤æ‚¨çš„è´¦å·å¯†ç ï¼Œä¸è¦ä¸ä»–äººåˆ†äº«</li>
          ${t.url.startsWith("https://")?"":'<li style="color: #e6a23c;">âš ï¸ å»ºè®®ä½¿ç”¨HTTPSè®¿é—®ä»¥ç¡®ä¿æ•°æ®å®‰å…¨</li>'}
        </ul>
        
        <div style="margin-top: 16px; padding: 12px; background: #f8f9fa; border-radius: 8px; font-size: 12px; color: #666;">
          <p style="margin: 0;">âœ… æ­¤ç½‘ç«™å·²é€šè¿‡å®˜æ–¹åŸŸåéªŒè¯ï¼Œå±äºå¯ä¿¡ä»»çš„çŸ¥åå¹³å°</p>
        </div>
      `,R.value=!0,I.value=!1,console.log("âœ… è¯†åˆ«ä¸ºå®˜æ–¹ç½‘ç«™ï¼Œç›´æ¥è¿”å›å®‰å…¨ç»“æœ");return}let o="";try{const s=await chrome.scripting.executeScript({target:{tabId:t.id},func:()=>({title:document.title,url:window.location.href,forms:document.querySelectorAll("form").length,links:document.querySelectorAll("a").length,scripts:document.querySelectorAll("script").length,iframes:document.querySelectorAll("iframe").length,inputs:document.querySelectorAll('input[type="password"], input[type="email"], input[type="text"]').length,hasHttps:window.location.protocol==="https:",metaDescription:document.querySelector('meta[name="description"]')?.getAttribute("content")||"",suspiciousElements:{hiddenIframes:document.querySelectorAll('iframe[style*="display:none"], iframe[style*="visibility:hidden"]').length,externalScripts:Array.from(document.querySelectorAll("script[src]")).filter(O=>{const B=O.src;return B&&!B.includes(window.location.hostname)}).length,popupScripts:document.body.innerHTML.includes("window.open")?1:0}})});if(s&&s[0]?.result){const r=s[0].result;o=`
é¡µé¢æ ‡é¢˜: ${r.title}
é¡µé¢URL: ${r.url}
åè®®: ${r.hasHttps?"HTTPS (å®‰å…¨)":"HTTP (ä¸å®‰å…¨)"}

é¡µé¢å…ƒç´ ç»Ÿè®¡:
- è¡¨å•æ•°é‡: ${r.forms}
- é“¾æ¥æ•°é‡: ${r.links}
- è„šæœ¬æ•°é‡: ${r.scripts}
- iframeæ•°é‡: ${r.iframes}
- è¾“å…¥æ¡†æ•°é‡: ${r.inputs}

å¯ç–‘å…ƒç´ :
- éšè—iframe: ${r.suspiciousElements.hiddenIframes}
- å¤–éƒ¨è„šæœ¬: ${r.suspiciousElements.externalScripts}
- å¼¹çª—è„šæœ¬: ${r.suspiciousElements.popupScripts}

é¡µé¢æè¿°: ${r.metaDescription||"æ— "}
        `.trim()}}catch(s){console.warn("æ— æ³•è·å–é¡µé¢å†…å®¹ï¼Œä»…ä½¿ç”¨URLåˆ†æ:",s),o=`é¡µé¢URL: ${t.url}
åè®®: ${t.url.startsWith("https://")?"HTTPS (å®‰å…¨)":"HTTP (ä¸å®‰å…¨)"}`}const i=U.value;let c="";i.length>0?(c=`

æ£€æµ‹åˆ°çš„å¨èƒ (${i.length}æ¡):
`,i.slice(0,5).forEach((s,r)=>{c+=`${r+1}. ${Y(s.type)} - ${s.level}çº§åˆ« - ${s.description}
`})):c=`

å½“å‰æœªæ£€æµ‹åˆ°å¨èƒã€‚`;const _=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${oe}`,"HTTP-Referer":"https://github.com/web-security-guardian","X-Title":"Web Security Guardian","Content-Type":"application/json"},body:JSON.stringify({model:"tngtech/deepseek-r1t2-chimera:free",messages:[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªç½‘ç»œå®‰å…¨ä¸“å®¶ï¼Œä¸“é—¨åˆ†æç½‘é¡µå®‰å…¨æ€§ã€‚è¯·å…¨é¢åˆ†ææä¾›çš„é¡µé¢ä¿¡æ¯ï¼Œè¯„ä¼°å®‰å…¨é£é™©ï¼Œå¹¶ç»™å‡ºä¸“ä¸šå»ºè®®ã€‚å›ç­”è¦è¯¦ç»†ä¸”ç»“æ„åŒ–ï¼ŒåŒ…å«ï¼š1.æ•´ä½“å®‰å…¨è¯„ä¼° 2.å‘ç°çš„é£é™©ç‚¹ 3.å®‰å…¨å»ºè®®ã€‚ç”¨ä¸­æ–‡å›ç­”ã€‚è¯„åˆ†æ ‡å‡†ï¼š65åˆ†åŠä»¥ä¸Šä¸ºå®‰å…¨ï¼Œ65åˆ†ä»¥ä¸‹éœ€æ³¨æ„é£é™©ã€‚"},{role:"user",content:`è¯·å¯¹ä»¥ä¸‹ç½‘é¡µè¿›è¡Œå…¨é¢çš„å®‰å…¨åˆ†æï¼š

${o}
${c}

è¯·ä»ä»¥ä¸‹è§’åº¦è¿›è¡Œåˆ†æï¼š
1. URLå’ŒåŸŸåå®‰å…¨æ€§
2. åè®®å®‰å…¨ï¼ˆHTTPS/HTTPï¼‰
3. é¡µé¢å…ƒç´ é£é™©è¯„ä¼°ï¼ˆè¡¨å•ã€è„šæœ¬ã€iframeç­‰ï¼‰
4. æ£€æµ‹åˆ°çš„å®‰å…¨å¨èƒåˆ†æ
5. å¯ç–‘è¡Œä¸ºè¯†åˆ«
6. **ç»¼åˆå®‰å…¨è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰**ã€å¿…é¡»æ˜ç¡®ç»™å‡ºè¯„åˆ†ï¼Œæ ¼å¼ï¼šç»¼åˆå®‰å…¨è¯„åˆ†ï¼šXXåˆ†ã€‘
7. å…·ä½“å®‰å…¨å»ºè®®

è¯„åˆ†æ ‡å‡†è¯´æ˜ï¼š
- 90-100åˆ†ï¼šä¼˜ç§€ï¼Œéå¸¸å®‰å…¨
- 80-89åˆ†ï¼šè‰¯å¥½ï¼Œå®‰å…¨å¯é 
- 65-79åˆ†ï¼šåˆæ ¼ï¼Œæ•´ä½“å®‰å…¨
- 50-64åˆ†ï¼šä¸€èˆ¬ï¼Œå­˜åœ¨é£é™©
- 0-49åˆ†ï¼šè¾ƒå·®ï¼Œæœ‰æ˜æ˜¾å®‰å…¨é—®é¢˜

è¯·ç»™å‡ºè¯¦ç»†çš„åˆ†ææŠ¥å‘Šï¼Œå¹¶åœ¨æŠ¥å‘Šä¸­æ˜ç¡®æ ‡æ³¨"ç»¼åˆå®‰å…¨è¯„åˆ†ï¼šXXåˆ†"ã€‚`}]})});if(!_.ok)throw new Error(`APIè¯·æ±‚å¤±è´¥: ${_.status}`);const f=(await _.json()).choices[0].message.content;console.log("ğŸ¤– AIåˆ†æç»“æœ:",f);let d=-1;const N=[/ç»¼åˆå®‰å…¨è¯„åˆ†[ï¼š:]\s*(\d+)\s*åˆ†/i,/å®‰å…¨è¯„åˆ†[ï¼š:]\s*(\d+)\s*åˆ†/i,/è¯„åˆ†[ï¼š:]\s*(\d+)\s*[åˆ†\/]/i,/(\d+)\s*åˆ†\s*\(0-100\)/i,/å¾—åˆ†[ï¼š:]\s*(\d+)/i,/åˆ†æ•°[ï¼š:]\s*(\d+)/i];for(const s of N){const r=f.match(s);if(r&&r[1]){d=parseInt(r[1]),console.log("ğŸ“Š æå–åˆ°è¯„åˆ†:",d);break}}if(d>=0)b.value=d>=65,console.log(`âœ… æ ¹æ®è¯„åˆ†åˆ¤æ–­: ${d}åˆ† - ${b.value?"å®‰å…¨":"å±é™©"}`);else{const s=["å±é™©","é«˜é£é™©","ä¸¥é‡å¨èƒ","ä¸å®‰å…¨","æ¶æ„","é’“é±¼"],r=["å®‰å…¨","å¯ä¿¡","æ­£å¸¸","æ— é£é™©","ä½é£é™©"],O=s.some(W=>f.includes(W)),B=r.some(W=>f.includes(W));b.value=B&&!O,console.log("âš ï¸ æœªæ‰¾åˆ°è¯„åˆ†ï¼Œä½¿ç”¨å…³é”®è¯åˆ¤æ–­:",b.value?"å®‰å…¨":"å±é™©")}if(w.value=f.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/###\s*(.*?)(<br>|$)/g,"<h4>$1</h4>").replace(/##\s*(.*?)(<br>|$)/g,"<h3>$1</h3>"),d>=0){const s=d>=80?"#67c23a":d>=65?"#e6a23c":"#f56c6c",r=d>=80?"ä¼˜ç§€":d>=65?"è‰¯å¥½":"éœ€æ³¨æ„";w.value=`
        <div style="padding: 12px; background: linear-gradient(135deg, ${s}22, ${s}11); border-left: 4px solid ${s}; border-radius: 8px; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 12px;">
            <div style="font-size: 32px; font-weight: bold; color: ${s};">${d}</div>
            <div>
              <div style="font-size: 14px; font-weight: 600; color: ${s};">ç»¼åˆå®‰å…¨è¯„åˆ†</div>
              <div style="font-size: 12px; color: #666;">çŠ¶æ€ï¼š${r} ${d>=65?"âœ… å®‰å…¨":"âš ï¸ éœ€æ³¨æ„"}</div>
            </div>
          </div>
        </div>
        ${w.value}
      `}R.value=!0,console.log("âœ… é¡µé¢æ‰«æå®Œæˆ")}catch(t){console.error("æ‰«æå¤±è´¥:",t),w.value=`<p style="color: #f56c6c;">âŒ æ‰«æå¤±è´¥: ${t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯"}</p><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`,b.value=!0,R.value=!0}finally{I.value=!1}}function fe(){typeof chrome<"u"&&chrome.runtime&&chrome.runtime.openOptionsPage()}async function he(){if(H.value.trim()){z.value=!0,A.value="";try{const t=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${oe}`,"HTTP-Referer":"https://github.com/web-security-guardian","X-Title":"Web Security Guardian","Content-Type":"application/json"},body:JSON.stringify({model:"tngtech/deepseek-r1t2-chimera:free",messages:[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªç½‘ç»œå®‰å…¨ä¸“å®¶ï¼Œä¸“é—¨è¯†åˆ«é’“é±¼ç½‘ç«™ã€‚è¯·åˆ†æç”¨æˆ·æä¾›çš„URLï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ã€‚å›ç­”è¦ç®€æ´æ˜äº†ï¼ŒåŒ…å«ï¼š1.åˆ¤æ–­ç»“æœï¼ˆå®‰å…¨/å±é™©ï¼‰2.ä¸»è¦åŸå›  3.é£é™©ç­‰çº§ã€‚ç”¨ä¸­æ–‡å›ç­”ï¼Œæ ¼å¼æ¸…æ™°ã€‚"},{role:"user",content:`è¯·åˆ†æè¿™ä¸ªç½‘å€æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ï¼š${H.value}

è¯·ä»ä»¥ä¸‹æ–¹é¢åˆ†æï¼š
1. åŸŸåç‰¹å¾ï¼ˆæ˜¯å¦ä»¿å†’çŸ¥åç½‘ç«™ï¼‰
2. URLç»“æ„ï¼ˆæ˜¯å¦æœ‰å¼‚å¸¸å­—ç¬¦æˆ–ç¼–ç ï¼‰
3. é¡¶çº§åŸŸåå¯ä¿¡åº¦
4. æ˜¯å¦åŒ…å«å¯ç–‘å…³é”®è¯
5. ç»¼åˆå®‰å…¨è¯„ä¼°`}]})});if(!t.ok)throw new Error(`APIè¯·æ±‚å¤±è´¥: ${t.status}`);const o=(await t.json()).choices[0].message.content,i=["å±é™©","é’“é±¼","ä¸å®‰å…¨","é£é™©","å¯ç–‘","ä»¿å†’","æ¬ºè¯ˆ"],c=["å®‰å…¨","æ­£å¸¸","å¯ä¿¡","åˆæ³•"],_=i.some(f=>o.includes(f)),v=c.some(f=>o.includes(f));C.value=!_||v&&!o.includes("é«˜é£é™©"),A.value=o.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/###\s*(.*?)(<br>|$)/g,"<h4>$1</h4>")}catch(t){console.error("AIæ£€æµ‹å¤±è´¥:",t),A.value=`<p style="color: #f56c6c;">âŒ æ£€æµ‹å¤±è´¥: ${t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯"}</p><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`,C.value=!0}finally{z.value=!1}}}async function J(){try{if(typeof chrome<"u"&&chrome.tabs){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t.url&&(L.value=t.url,P.value=new URL(t.url).hostname,V.value=t.url.startsWith("https://"),await M(t.url))}}catch(t){console.error("è·å–é¡µé¢ä¿¡æ¯å¤±è´¥:",t),P.value="æ— æ³•è·å–"}}async function M(t){let e=100,o="";try{o=new URL(t).hostname}catch{o=t}m.stats;const i=m.recentThreats,c=i.filter(v=>{try{return new URL(v.url).hostname===o}catch{return v.url.includes(o)}});c.forEach(v=>{switch(v.level){case"critical":e-=30;break;case"high":e-=20;break;case"medium":e-=10;break;case"low":e-=5;break}});const _=t.includes("localhost")||t.includes("127.0.0.1");!t.startsWith("https://")&&!_&&(e-=15,console.log("âŒ æœªä½¿ç”¨HTTPSï¼Œæ‰£15åˆ†")),e=Math.max(0,Math.min(100,e)),m.currentPageAnalysis={url:t,score:e,threats:c,recommendations:e<90?["å‘ç°å®‰å…¨å¨èƒï¼Œå»ºè®®è°¨æ…æ“ä½œ"]:["ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½"],scanTime:Date.now(),isSecure:e>=90},console.log(`ğŸ” é¡µé¢å®‰å…¨è¯„åˆ†: ${e}`),console.log(`ğŸ“Š å½“å‰é¡µé¢å¨èƒ: ${c.length} / æ€»å¨èƒ: ${i.length}`)}function ye(){typeof chrome<"u"&&chrome.storage&&chrome.storage.onChanged.addListener((t,e)=>{e==="local"&&(console.log("ğŸ“¦ Storage changed:",t),(t.security_stats||t.threat_history)&&(m.loadStats(),m.loadThreats(),L.value&&M(L.value)))})}function ve(){typeof chrome<"u"&&chrome.tabs&&chrome.tabs.onActivated.addListener(async()=>{console.log("ğŸ”„ Tab switched, refreshing page info"),await J()})}return we(async()=>{console.log("ğŸ¨ Popup opened"),await m.initialize(),await J(),ye(),ve(),setInterval(async()=>{await m.loadStats(),await m.loadThreats(),await M(L.value)},2e3)}),(t,e)=>{const o=T("el-icon"),i=T("el-button"),c=T("el-badge"),_=T("el-progress"),v=T("el-tag"),f=T("el-input"),d=T("el-dialog"),N=T("el-divider");return p(),$("div",Be,[a("div",De,[a("div",Ee,[n(o,{size:"24",color:"#667eea"},{default:l(()=>[n(g(Te))]),_:1}),e[4]||(e[4]=a("h1",null,"å®‰å…¨å®ˆæŠ¤è€…",-1))]),a("div",Ve,[n(c,{value:F.value,class:"badge"},{default:l(()=>[n(i,{type:X.value?"success":"danger",size:"small",circle:""},{default:l(()=>[n(o,null,{default:l(()=>[X.value?(p(),S(g(ke),{key:0})):(p(),S(g($e),{key:1}))]),_:1})]),_:1},8,["type"])]),_:1},8,["value"])])]),a("div",qe,[n(_,{type:"circle",percentage:k.value,color:ie(k.value),width:80},{default:l(({percentage:s})=>[a("span",Me,u(s),1)]),_:1},8,["percentage","color"]),a("div",Ne,[e[5]||(e[5]=a("h3",null,"å®‰å…¨è¯„åˆ†",-1)),a("p",null,u(ce(k.value)),1)])]),a("div",Oe,[e[6]||(e[6]=a("h3",null,"å½“å‰é¡µé¢",-1)),a("div",We,[a("div",je,u(P.value),1),a("div",Xe,[n(v,{type:V.value?"success":"warning",size:"small"},{default:l(()=>[x(u(V.value?"HTTPS":"HTTP"),1)]),_:1},8,["type"]),n(v,{type:ae.value,size:"small"},{default:l(()=>[x(u(ne.value),1)]),_:1},8,["type"])])])]),a("div",Ge,[a("div",Ke,[a("div",Fe,u(K.value.blockedThreats),1),e[7]||(e[7]=a("div",{class:"stat-label"},"å·²é˜»æ­¢å¨èƒ",-1))]),a("div",Ye,[a("div",Je,u(K.value.totalThreats),1),e[8]||(e[8]=a("div",{class:"stat-label"},"æ£€æµ‹åˆ°å¨èƒ",-1))]),a("div",Qe,[a("div",Ze,u(F.value),1),e[9]||(e[9]=a("div",{class:"stat-label"},"ä»Šæ—¥é˜»æ­¢",-1))])]),G.value.length>0?(p(),$("div",et,[e[10]||(e[10]=a("h3",null,"æœ€è¿‘å¨èƒ",-1)),a("div",tt,[(p(!0),$(xe,null,Se(G.value.slice(0,3),s=>(p(),$("div",{key:s.id,class:"threat-item"},[n(o,{color:ue(s.level)},{default:l(()=>[n(g(Q))]),_:1},8,["color"]),a("div",ot,[a("div",st,u(Y(s.type)),1),a("div",at,u(de(s.timestamp)),1)]),n(v,{type:s.blocked?"success":"warning",size:"small"},{default:l(()=>[x(u(s.blocked?"å·²é˜»æ­¢":"å·²æ£€æµ‹"),1)]),_:2},1032,["type"])]))),128))])])):D("",!0),a("div",nt,[n(i,{type:"primary",onClick:ge,loading:I.value,style:{flex:"1"}},{default:l(()=>[n(o,null,{default:l(()=>[n(g(Pe))]),_:1}),e[11]||(e[11]=x(" æ‰«æå½“å‰é¡µé¢ ",-1))]),_:1},8,["loading"]),n(i,{onClick:e[0]||(e[0]=s=>q.value=!0),type:"warning"},{default:l(()=>[n(o,null,{default:l(()=>[n(g(Q))]),_:1}),e[12]||(e[12]=x(" AIæ£€æµ‹ ",-1))]),_:1}),n(i,{onClick:fe},{default:l(()=>[n(o,null,{default:l(()=>[n(g(Le))]),_:1}),e[13]||(e[13]=x(" è®¾ç½® ",-1))]),_:1})]),n(d,{modelValue:q.value,"onUpdate:modelValue":e[2]||(e[2]=s=>q.value=s),title:"é’“é±¼ç½‘ç«™æ£€æµ‹",width:"90%","close-on-click-modal":!1},{default:l(()=>[a("div",rt,[n(f,{modelValue:H.value,"onUpdate:modelValue":e[1]||(e[1]=s=>H.value=s),placeholder:"è¾“å…¥è¦æ£€æµ‹çš„ç½‘å€ï¼Œä¾‹å¦‚: https://example.com",size:"large",clearable:""},{prepend:l(()=>[n(o,null,{default:l(()=>[n(g(He))]),_:1})]),_:1},8,["modelValue"]),n(i,{type:"primary",onClick:he,loading:z.value,disabled:!H.value.trim(),style:{width:"100%","margin-top":"12px"},size:"large"},{default:l(()=>[x(u(z.value?"åˆ†æä¸­...":"å¼€å§‹æ£€æµ‹"),1)]),_:1},8,["loading","disabled"]),A.value?(p(),$("div",{key:0,class:Z(["result-box",re.value])},[a("div",lt,[n(o,{size:"24"},{default:l(()=>[C.value?(p(),S(g(ee),{key:0})):(p(),S(g(te),{key:1}))]),_:1}),a("h3",null,u(le.value),1)]),a("div",{class:"result-content",innerHTML:A.value},null,8,it)],2)):D("",!0),z.value?(p(),$("div",ct,[n(o,{class:"is-loading"},{default:l(()=>[n(g(Ae))]),_:1}),e[14]||(e[14]=a("p",null,"AIæ­£åœ¨åˆ†æç½‘å€ç‰¹å¾ï¼Œè¯·ç¨å€™...",-1))])):D("",!0)])]),_:1},8,["modelValue"]),n(d,{modelValue:R.value,"onUpdate:modelValue":e[3]||(e[3]=s=>R.value=s),title:"ğŸ” AIé¡µé¢å®‰å…¨æ‰«ææŠ¥å‘Š",width:"90%","close-on-click-modal":!1},{default:l(()=>[a("div",ut,[w.value?(p(),$("div",{key:0,class:Z(["result-box",b.value?"safe":"danger"])},[a("div",dt,[n(o,{size:"24"},{default:l(()=>[b.value?(p(),S(g(ee),{key:0})):(p(),S(g(te),{key:1}))]),_:1}),a("h3",null,u(b.value?"âœ… é¡µé¢æ•´ä½“å®‰å…¨":"âš ï¸ å‘ç°å®‰å…¨é£é™©"),1)]),a("div",{class:"result-content",innerHTML:w.value},null,8,mt)],2)):D("",!0),a("div",pt,[n(N),a("div",gt,[a("span",ft," æ‰«ææ—¶é—´: "+u(new Date().toLocaleString("zh-CN")),1),a("span",ht," å½“å‰é¡µé¢: "+u(P.value),1)])])])]),_:1},8,["modelValue"])])}}}),vt=ze(yt,[["__scopeId","data-v-2213881e"]]),E=Ce(vt),_t=Re();E.use(_t);E.use(Ie);for(const[j,m]of Object.entries(Ue))E.component(j,m);E.mount("#app");
