import{d as I,u as W,r as X,c as h,o as j,a as w,b as e,e as s,w as o,f as r,g as k,t as c,F,h as G,i,E as m,_ as O,j as q,k as H,l as J,m as K}from"./_plugin-vue_export-helper-Ch0c2NRu.js";import"./security-6RDsp77e.js";const Q={class:"options-page"},Y={class:"settings-section"},Z={class:"setting-group"},$={class:"setting-item"},tt={class:"setting-item"},et={class:"setting-item"},st={class:"setting-item"},lt={class:"setting-item"},ot={class:"setting-group"},nt={class:"setting-item"},at={class:"setting-item"},it={class:"stats-section"},ut={class:"stats-cards"},rt={class:"stat-content"},dt={class:"stat-number"},ct={class:"stat-content"},pt={class:"stat-number"},mt={class:"stat-content"},ft={class:"stat-number"},vt={class:"threat-types"},_t={class:"threat-type-name"},gt={class:"threat-count"},bt={class:"threats-section"},Vt={class:"threats-header"},yt={class:"about-section"},ht={class:"about-content"},wt={class:"tech-stack"},kt={class:"tech-tags"},Tt={class:"footer-actions"},Pt=I({__name:"App",setup(T){const u=W(),P=X("general"),n=h(()=>u.settings),f=h(()=>u.stats),U=h(()=>u.recentThreats);function S(a){return{malicious_url:"æ¶æ„URL",xss_attack:"XSSæ”»å‡»",tracker:"éšç§è¿½è¸ª",insecure_form:"ä¸å®‰å…¨è¡¨å•",suspicious_script:"å¯ç–‘è„šæœ¬",phishing:"é’“é±¼ç½‘ç«™"}[a]||a}function x(a){return{malicious_url:"#f56c6c",xss_attack:"#e6a23c",tracker:"#909399",insecure_form:"#67c23a",suspicious_script:"#409eff",phishing:"#f56c6c"}[a]||"#909399"}function C(a){return{low:"info",medium:"warning",high:"danger",critical:"danger"}[a]||"info"}function B(a){const t=f.value.totalThreats;return t>0?Math.round(a/t*100):0}function E(a){return new Date(a).toLocaleString("zh-CN")}async function L(){try{await u.updateSettings(n.value),m.success("è®¾ç½®å·²ä¿å­˜")}catch{m.error("ä¿å­˜è®¾ç½®å¤±è´¥")}}async function M(){try{await u.updateSettings({maliciousUrlProtection:!0,xssProtection:!0,trackerBlocking:!0,formProtection:!0,phishingProtection:!0,notifications:!0,autoUpdate:!0,strictMode:!1}),m.success("è®¾ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼")}catch{m.error("é‡ç½®è®¾ç½®å¤±è´¥")}}async function z(){try{await u.clearAllThreats(),m.success("å¨èƒå†å²å·²æ¸…é™¤")}catch{m.error("æ¸…é™¤å†å²å¤±è´¥")}}function A(){m.info("å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...")}return j(async()=>{await u.initialize()}),(a,t)=>{const p=r("el-switch"),g=r("el-tab-pane"),v=r("el-card"),N=r("el-progress"),b=r("el-button"),d=r("el-tag"),_=r("el-table-column"),D=r("el-table"),R=r("el-tabs");return k(),w("div",Q,[t[35]||(t[35]=e("div",{class:"header"},[e("h1",null,"ğŸ›¡ï¸ Web Security Guardian è®¾ç½®"),e("p",null,"é…ç½®æ‚¨çš„æµè§ˆå™¨å®‰å…¨é˜²æŠ¤é€‰é¡¹")],-1)),s(R,{modelValue:P.value,"onUpdate:modelValue":t[7]||(t[7]=l=>P.value=l),class:"settings-tabs"},{default:o(()=>[s(g,{label:"åŸºæœ¬è®¾ç½®",name:"general"},{default:o(()=>[e("div",Y,[t[15]||(t[15]=e("h3",null,"é˜²æŠ¤åŠŸèƒ½",-1)),e("div",Z,[e("div",$,[t[8]||(t[8]=e("div",{class:"setting-info"},[e("h4",null,"æ¶æ„URLé˜²æŠ¤"),e("p",null,"è‡ªåŠ¨æ£€æµ‹å¹¶é˜»æ­¢è®¿é—®å·²çŸ¥çš„æ¶æ„ç½‘ç«™")],-1)),s(p,{modelValue:n.value.maliciousUrlProtection,"onUpdate:modelValue":t[0]||(t[0]=l=>n.value.maliciousUrlProtection=l)},null,8,["modelValue"])]),e("div",tt,[t[9]||(t[9]=e("div",{class:"setting-info"},[e("h4",null,"XSSæ”»å‡»é˜²æŠ¤"),e("p",null,"æ£€æµ‹å¹¶é˜»æ­¢è·¨ç«™è„šæœ¬æ”»å‡»")],-1)),s(p,{modelValue:n.value.xssProtection,"onUpdate:modelValue":t[1]||(t[1]=l=>n.value.xssProtection=l)},null,8,["modelValue"])]),e("div",et,[t[10]||(t[10]=e("div",{class:"setting-info"},[e("h4",null,"éšç§è¿½è¸ªé˜»æ­¢"),e("p",null,"é˜»æ­¢ç¬¬ä¸‰æ–¹è¿½è¸ªå™¨æ”¶é›†æ‚¨çš„æ•°æ®")],-1)),s(p,{modelValue:n.value.trackerBlocking,"onUpdate:modelValue":t[2]||(t[2]=l=>n.value.trackerBlocking=l)},null,8,["modelValue"])]),e("div",st,[t[11]||(t[11]=e("div",{class:"setting-info"},[e("h4",null,"è¡¨å•å®‰å…¨æ£€æŸ¥"),e("p",null,"æ£€æŸ¥è¡¨å•æäº¤çš„å®‰å…¨æ€§")],-1)),s(p,{modelValue:n.value.formProtection,"onUpdate:modelValue":t[3]||(t[3]=l=>n.value.formProtection=l)},null,8,["modelValue"])]),e("div",lt,[t[12]||(t[12]=e("div",{class:"setting-info"},[e("h4",null,"é’“é±¼ç½‘ç«™é˜²æŠ¤"),e("p",null,"è¯†åˆ«å¹¶è­¦å‘Šé’“é±¼ç½‘ç«™")],-1)),s(p,{modelValue:n.value.phishingProtection,"onUpdate:modelValue":t[4]||(t[4]=l=>n.value.phishingProtection=l)},null,8,["modelValue"])])]),t[16]||(t[16]=e("h3",null,"é€šçŸ¥è®¾ç½®",-1)),e("div",ot,[e("div",nt,[t[13]||(t[13]=e("div",{class:"setting-info"},[e("h4",null,"å®‰å…¨é€šçŸ¥"),e("p",null,"å½“æ£€æµ‹åˆ°å¨èƒæ—¶æ˜¾ç¤ºé€šçŸ¥")],-1)),s(p,{modelValue:n.value.notifications,"onUpdate:modelValue":t[5]||(t[5]=l=>n.value.notifications=l)},null,8,["modelValue"])]),e("div",at,[t[14]||(t[14]=e("div",{class:"setting-info"},[e("h4",null,"ä¸¥æ ¼æ¨¡å¼"),e("p",null,"å¯ç”¨æ›´ä¸¥æ ¼çš„å®‰å…¨æ£€æŸ¥")],-1)),s(p,{modelValue:n.value.strictMode,"onUpdate:modelValue":t[6]||(t[6]=l=>n.value.strictMode=l)},null,8,["modelValue"])])])])]),_:1}),s(g,{label:"ç»Ÿè®¡ä¿¡æ¯",name:"stats"},{default:o(()=>[e("div",it,[e("div",ut,[s(v,{class:"stat-card"},{default:o(()=>[e("div",rt,[e("div",dt,c(f.value.totalThreats),1),t[17]||(t[17]=e("div",{class:"stat-label"},"æ€»å¨èƒæ•°",-1))])]),_:1}),s(v,{class:"stat-card"},{default:o(()=>[e("div",ct,[e("div",pt,c(f.value.blockedThreats),1),t[18]||(t[18]=e("div",{class:"stat-label"},"å·²é˜»æ­¢",-1))])]),_:1}),s(v,{class:"stat-card"},{default:o(()=>[e("div",mt,[e("div",ft,c(f.value.allowedThreats),1),t[19]||(t[19]=e("div",{class:"stat-label"},"å·²å…è®¸",-1))])]),_:1})]),s(v,{class:"chart-card"},{default:o(()=>[t[20]||(t[20]=e("h3",null,"å¨èƒç±»å‹åˆ†å¸ƒ",-1)),e("div",vt,[(k(!0),w(F,null,G(f.value.threatsByType,(l,y)=>(k(),w("div",{key:y,class:"threat-type-item"},[e("span",_t,c(S(y)),1),s(N,{percentage:B(l),color:x(y)},null,8,["percentage","color"]),e("span",gt,c(l),1)]))),128))])]),_:1})])]),_:1}),s(g,{label:"å¨èƒå†å²",name:"threats"},{default:o(()=>[e("div",bt,[e("div",Vt,[t[22]||(t[22]=e("h3",null,"æœ€è¿‘å¨èƒè®°å½•",-1)),s(b,{onClick:z,type:"danger",size:"small"},{default:o(()=>[...t[21]||(t[21]=[i(" æ¸…é™¤å†å² ",-1)])]),_:1})]),s(D,{data:U.value,style:{width:"100%"}},{default:o(()=>[s(_,{prop:"type",label:"ç±»å‹",width:"120"},{default:o(l=>[s(d,{type:C(l.row.level),size:"small"},{default:o(()=>[i(c(S(l.row.type)),1)]),_:2},1032,["type"])]),_:1}),s(_,{prop:"url",label:"URL","min-width":"200","show-overflow-tooltip":""}),s(_,{prop:"description",label:"æè¿°","min-width":"150"}),s(_,{prop:"timestamp",label:"æ—¶é—´",width:"150"},{default:o(l=>[i(c(E(l.row.timestamp)),1)]),_:1}),s(_,{prop:"blocked",label:"çŠ¶æ€",width:"80"},{default:o(l=>[s(d,{type:l.row.blocked?"success":"warning",size:"small"},{default:o(()=>[i(c(l.row.blocked?"å·²é˜»æ­¢":"å·²æ£€æµ‹"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])])]),_:1}),s(g,{label:"å…³äº",name:"about"},{default:o(()=>[e("div",yt,[s(v,null,{default:o(()=>[e("div",ht,[t[30]||(t[30]=e("div",{class:"app-info"},[e("h2",null,"ğŸ›¡ï¸ Web Security Guardian"),e("p",{class:"version"},"ç‰ˆæœ¬ 1.0.0"),e("p",{class:"description"}," åŸºäºVue3 + Viteå¼€å‘çš„ç°ä»£åŒ–æµè§ˆå™¨å®‰å…¨é˜²æŠ¤æ’ä»¶ï¼Œ ä¸ºæ‚¨æä¾›å…¨é¢çš„Webåº”ç”¨å±‚å®‰å…¨é˜²æŠ¤ã€‚ ")],-1)),t[31]||(t[31]=e("div",{class:"features"},[e("h3",null,"ä¸»è¦åŠŸèƒ½"),e("ul",null,[e("li",null,"ğŸš« æ¶æ„URLæ£€æµ‹ä¸é˜»æ­¢"),e("li",null,"âš ï¸ XSSæ”»å‡»å®æ—¶é˜²æŠ¤"),e("li",null,"ğŸ‘ï¸ éšç§è¿½è¸ªå™¨é˜»æ­¢"),e("li",null,"ğŸ”’ è¡¨å•å®‰å…¨æ£€æŸ¥"),e("li",null,"ğŸ£ é’“é±¼ç½‘ç«™è¯†åˆ«"),e("li",null,"ğŸ“Š è¯¦ç»†çš„å®‰å…¨ç»Ÿè®¡")])],-1)),e("div",wt,[t[29]||(t[29]=e("h3",null,"æŠ€æœ¯æ ˆ",-1)),e("div",kt,[s(d,null,{default:o(()=>[...t[23]||(t[23]=[i("Vue 3",-1)])]),_:1}),s(d,null,{default:o(()=>[...t[24]||(t[24]=[i("TypeScript",-1)])]),_:1}),s(d,null,{default:o(()=>[...t[25]||(t[25]=[i("Vite",-1)])]),_:1}),s(d,null,{default:o(()=>[...t[26]||(t[26]=[i("Pinia",-1)])]),_:1}),s(d,null,{default:o(()=>[...t[27]||(t[27]=[i("Element Plus",-1)])]),_:1}),s(d,null,{default:o(()=>[...t[28]||(t[28]=[i("Chrome Extensions API",-1)])]),_:1})])])])]),_:1})])]),_:1})]),_:1},8,["modelValue"]),e("div",Tt,[s(b,{onClick:L,type:"primary"},{default:o(()=>[...t[32]||(t[32]=[i("ä¿å­˜è®¾ç½®",-1)])]),_:1}),s(b,{onClick:M},{default:o(()=>[...t[33]||(t[33]=[i("é‡ç½®ä¸ºé»˜è®¤",-1)])]),_:1}),s(b,{onClick:A},{default:o(()=>[...t[34]||(t[34]=[i("å¯¼å‡ºæ•°æ®",-1)])]),_:1})])])}}}),St=O(Pt,[["__scopeId","data-v-dba137f9"]]),V=q(St),Ut=H();V.use(Ut);V.use(J);for(const[T,u]of Object.entries(K))V.component(T,u);V.mount("#app");
